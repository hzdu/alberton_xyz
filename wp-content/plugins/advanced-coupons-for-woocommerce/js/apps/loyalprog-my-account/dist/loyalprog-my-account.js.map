{"version":3,"sources":["webpack:///loyalprog-my-account.js","webpack:///webpack/bootstrap d85db4c538a97b9c16f2","webpack:///./src/my_account.js","webpack:///./src/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","my_account_events","$","jQuery","loyalProg","document","querySelector","on","calculate_amount_preview_from_points","calculate_points_from_amount_preview","user_redeem_points","validate_points_amount","window","fix_overlay_position","ajax_refresh_user_points","trigger","$this","this","$field","closest","$display","find","amount","val","acfw_loyalprog_args","redeem_ratio","currency_ratio","formatted","toFixed","e","$points","parseFloat","points","parseInt","type","refresh_user_points","user_points","worth","expire_msg","userPoints","pointsWorth","expireMsg","pointsField","text","prop","replaceWith","html","append_user_coupon","code","date","action","couponTable","tableTbody","applyMarkup","is_uc_module","coupon_apply_text","remove","prepend","post","ajaxurl","nonce","refresh_nonce","response","status","$form","$button","min","max","preventDefault","formData","serializeArray","toggle_overlay","alert","error_msg","overlay","leftPadding","offset","left","width","css","toggle","display","ready"],"mappings":"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","file":"loyalprog-my-account.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 2);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.my_account_events = my_account_events;\n/* global jQuery , acfw_loyalprog_args */\n\n/**\n * My account loyalty program tab events.\n * \n * @since 1.9\n * \n * @param {object} $ jQuery object.\n */\nfunction my_account_events() {\n    var $ = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : jQuery;\n\n\n    var loyalProg = document.querySelector(\"#acfw-loyalty-programs-myaccount\");\n\n    $(loyalProg).on(\"change keyup\", \"#redeem_points\", calculate_amount_preview_from_points);\n    $(loyalProg).on(\"change keyup\", \"#redeem_points_worth\", calculate_points_from_amount_preview);\n    $(loyalProg).on(\"submit\", \"#redeem-points-form\", user_redeem_points);\n    $(loyalProg).on(\"keyup mouseup mousewheel validate\", \"#redeem_points\", validate_points_amount);\n    $(window).on(\"resize\", fix_overlay_position);\n\n    ajax_refresh_user_points();\n    $(window).trigger(\"resize\");\n}\n\n/**\n * Calculate amount preview when redeem points input value is changed.\n * \n * @since 1.9\n */\nfunction calculate_amount_preview_from_points() {\n\n    var $this = jQuery(this),\n        $field = $this.closest(\"#redeem_points_field\"),\n        $display = $field.find(\"#redeem_points_worth\"),\n        amount = $this.val() / acfw_loyalprog_args.redeem_ratio * acfw_loyalprog_args.currency_ratio,\n        formatted = amount.toFixed(2);\n\n    $display.val(\"\" + formatted);\n}\n\n/**\n * Calculate points based on amount preview value change.\n * \n * @since 1.9\n * \n * @param {object} e Event object.\n */\nfunction calculate_points_from_amount_preview(e) {\n\n    var $this = jQuery(this),\n        $field = $this.closest(\"#redeem_points_field\"),\n        $points = $field.find(\"#redeem_points\");\n\n    var amount = parseFloat($this.val());\n    amount = amount ? amount : 0;\n\n    var points = parseInt(amount / acfw_loyalprog_args.currency_ratio * acfw_loyalprog_args.redeem_ratio);\n\n    if (e.type == \"change\") $this.val(amount.toFixed(2));\n    $points.val(points);\n    $points.trigger(\"validate\");\n}\n\n/**\n * Function to update user points display.\n * \n * @since 1.9\n * @since 1.11 Add points expiration message support.\n * \n * @param {int}    user_points User points new value.\n * @param {string} worth       Points worth on price format.\n * @param {string} expire_msg  Points expiration message.\n */\nfunction refresh_user_points(user_points, worth) {\n    var expire_msg = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \"\";\n\n\n    var loyalProg = document.querySelector(\"#acfw-loyalty-programs-myaccount\"),\n        userPoints = loyalProg.querySelector(\".user-points strong\"),\n        pointsWorth = loyalProg.querySelector(\".user-points em span.amount\"),\n        expireMsg = loyalProg.querySelector(\".user-points .expiry-note\"),\n        pointsField = loyalProg.querySelector(\"#redeem_points\");\n\n    jQuery(userPoints).text(user_points);\n    jQuery(pointsField).prop(\"max\", user_points);\n    jQuery(pointsWorth).replaceWith(worth);\n    jQuery(expireMsg).html(expire_msg);\n}\n\n/**\n * Function to append user coupon to table.\n * \n * @since 1.9\n * \n * @param {object} object Destructurized object of coupon data. \n */\nfunction append_user_coupon(_ref) {\n    var code = _ref.code,\n        amount = _ref.amount,\n        date = _ref.date,\n        action = _ref.action;\n\n\n    var loyalProg = document.querySelector(\"#acfw-loyalty-programs-myaccount\"),\n        couponTable = loyalProg.querySelector(\".user-redeemed-coupons table\"),\n        tableTbody = couponTable.querySelector(\"tbody\");\n\n    var applyMarkup = \"\";\n\n    if (acfw_loyalprog_args.is_uc_module && action) {\n        applyMarkup = \"\\n            <a class=\\\"button\\\" href=\\\"\" + action + \"\\\">\\n                \" + acfw_loyalprog_args.coupon_apply_text + \"\\n            </a>\\n        \";\n    }\n\n    jQuery(tableTbody).find(\"tr.no-coupon-tr\").remove();\n\n    jQuery(tableTbody).prepend(\"\\n        <tr class=\\\"new\\\">\\n            <td class=\\\"coupon_code\\\">\" + code + \"</td>\\n            <td class=\\\"coupon_amount\\\">\" + amount + \"</td>\\n            <td class=\\\"coupon_created\\\">\" + date + \"</td>\\n            <td class=\\\"actions\\\">\" + applyMarkup + \"</td>\\n        </tr>\\n    \");\n}\n\n/**\n * AJAX refresh user points.\n * \n * @since 1.9\n */\nfunction ajax_refresh_user_points() {\n\n    jQuery.post(acfw_loyalprog_args.ajaxurl, {\n        action: \"acfw_lp_refresh_user_points\",\n        nonce: acfw_loyalprog_args.refresh_nonce\n    }, function (response) {\n\n        if (response.status == \"success\") refresh_user_points(response.user_points, response.worth, response.expire_msg);\n    }, \"json\");\n}\n\n/**\n * When input field has invalid points value, set button as disabled.\n * \n * @since 1.9\n */\nfunction validate_points_amount() {\n\n    var $this = jQuery(this),\n        $form = $this.closest(\"#redeem-points-form\"),\n        $button = $form.find(\"#redeem_submit_field button\"),\n        val = parseInt($this.val()),\n        min = parseInt($this.prop(\"min\")),\n        max = parseInt($this.prop(\"max\"));\n\n    if (val !== 0 && val >= min && val <= max) $button.prop(\"disabled\", false);else $button.prop(\"disabled\", true);\n}\n\n/**\n * Function to redeem user points.\n * \n * @since 1.9\n */\nfunction user_redeem_points(e) {\n\n    e.preventDefault();\n    var $form = jQuery(this),\n        formData = $form.serializeArray();\n\n    $form.find(\".input-text,button\").prop(\"disabled\", true);\n    toggle_overlay();\n\n    jQuery.post(acfw_loyalprog_args.ajaxurl, formData, function (response) {\n\n        if (response.status == \"success\") {\n\n            refresh_user_points(response.points, response.worth, response.expire_msg);\n            append_user_coupon(response);\n        } else {\n            // TODO: change to vex.\n            alert(response.error_msg);\n        }\n\n        $form.find(\".input-text\").val(0);\n        $form.find(\".input-text,.button\").prop(\"disabled\", false);\n        toggle_overlay(\"hide\");\n    }, \"json\");\n}\n\n/**\n * Fix overlay position on window resize and first load.\n * \n * @since 1.9\n */\nfunction fix_overlay_position() {\n\n    var loyalProg = document.querySelector(\"#acfw-loyalty-programs-myaccount\"),\n        overlay = loyalProg.querySelector(\".acfw-overlay\"),\n        leftPadding = jQuery(loyalProg).offset().left + (jQuery(loyalProg).width() / 2 - 20);\n\n    jQuery(overlay).css('backgroundPosition', leftPadding + \"px 50%\");\n}\n\n/**\n * Toggle overlay display.\n * \n * @param {string} toggle Hide or show. \n */\nfunction toggle_overlay() {\n    var toggle = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"show\";\n\n\n    var loyalProg = document.querySelector(\"#acfw-loyalty-programs-myaccount\"),\n        overlay = loyalProg.querySelector(\".acfw-overlay\"),\n        display = toggle == \"show\" ? \"block\" : \"none\";\n\n    jQuery(overlay).css(\"display\", display);\n}\n\n/***\n * Format money based on parameters.\n * source: https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-dollars-currency-string-in-javascript#149099\n * \n * @since 1.9\n * \n * @param {float}     amount       Amount to format.\n * @param {int}       decimalCount Decimal space count.\n * @param {string}    decimal      Decimal symbol.\n * @param {thousands} thousands    Thousands symbol.\n */\nfunction format_money(amount) {\n    var decimalCount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;\n    var decimal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : \".\";\n    var thousands = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : \",\";\n\n\n    decimalCount = Math.abs(decimalCount);\n    decimalCount = isNaN(decimalCount) ? 2 : decimalCount;\n\n    var negativeSign = amount < 0 ? \"-\" : \"\";\n\n    var i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();\n    var j = i.length > 3 ? i.length % 3 : 0;\n\n    return negativeSign + (j ? i.substr(0, j) + thousands : '') + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousands) + (decimalCount ? decimal + Math.abs(amount - i).toFixed(decimalCount).slice(2) : \"\");\n};\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(1);\n\nvar _my_account = __webpack_require__(0);\n\n/* global jQuery */\njQuery(document).ready(function ($) {\n\n    (0, _my_account.my_account_events)($);\n});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// loyalprog-my-account.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d85db4c538a97b9c16f2","/* global jQuery , acfw_loyalprog_args */\n\n/**\n * My account loyalty program tab events.\n * \n * @since 1.9\n * \n * @param {object} $ jQuery object.\n */\nexport function my_account_events($ = jQuery) {\n\n    const loyalProg = document.querySelector( \"#acfw-loyalty-programs-myaccount\" );\n\n    $( loyalProg ).on( \"change keyup\" , \"#redeem_points\" , calculate_amount_preview_from_points );\n    $( loyalProg ).on( \"change keyup\" , \"#redeem_points_worth\" , calculate_points_from_amount_preview );\n    $( loyalProg ).on( \"submit\" , \"#redeem-points-form\" , user_redeem_points );\n    $( loyalProg ).on( \"keyup mouseup mousewheel validate\" , \"#redeem_points\" , validate_points_amount );\n    $( window ).on( \"resize\" , fix_overlay_position );\n\n    ajax_refresh_user_points();\n    $( window ).trigger( \"resize\" );\n}\n\n/**\n * Calculate amount preview when redeem points input value is changed.\n * \n * @since 1.9\n */\nfunction calculate_amount_preview_from_points() {\n\n    const $this   = jQuery( this ),\n        $field    = $this.closest( \"#redeem_points_field\" ),\n        $display  = $field.find( \"#redeem_points_worth\" ),\n        amount    = ( $this.val() / acfw_loyalprog_args.redeem_ratio ) * acfw_loyalprog_args.currency_ratio,\n        formatted = amount.toFixed(2);\n\n    $display.val( `${ formatted }` );\n}\n\n/**\n * Calculate points based on amount preview value change.\n * \n * @since 1.9\n * \n * @param {object} e Event object.\n */\nfunction calculate_points_from_amount_preview(e) {\n\n    const $this = jQuery( this ),\n        $field  = $this.closest( \"#redeem_points_field\" ),\n        $points = $field.find( \"#redeem_points\" );\n\n    let amount = parseFloat( $this.val() );\n    amount = amount ? amount : 0;\n\n    let points = parseInt( ( amount / acfw_loyalprog_args.currency_ratio ) * acfw_loyalprog_args.redeem_ratio );\n\n    if ( e.type == \"change\" ) $this.val( amount.toFixed(2) );\n    $points.val( points );\n    $points.trigger( \"validate\" );\n}\n\n/**\n * Function to update user points display.\n * \n * @since 1.9\n * @since 1.11 Add points expiration message support.\n * \n * @param {int}    user_points User points new value.\n * @param {string} worth       Points worth on price format.\n * @param {string} expire_msg  Points expiration message.\n */\nfunction refresh_user_points( user_points , worth , expire_msg = \"\" ) {\n\n    const loyalProg = document.querySelector( \"#acfw-loyalty-programs-myaccount\" ),\n        userPoints  = loyalProg.querySelector( \".user-points strong\" ),\n        pointsWorth = loyalProg.querySelector( \".user-points em span.amount\" ),\n        expireMsg   = loyalProg.querySelector( \".user-points .expiry-note\" ),\n        pointsField = loyalProg.querySelector( \"#redeem_points\" );\n\n    jQuery( userPoints ).text( user_points );\n    jQuery( pointsField ).prop( \"max\" , user_points );\n    jQuery( pointsWorth ).replaceWith( worth );\n    jQuery( expireMsg ).html( expire_msg );\n}\n\n/**\n * Function to append user coupon to table.\n * \n * @since 1.9\n * \n * @param {object} object Destructurized object of coupon data. \n */\nfunction append_user_coupon( { code , amount , date , action } ) {\n\n    const loyalProg  = document.querySelector( \"#acfw-loyalty-programs-myaccount\" ),\n        couponTable  = loyalProg.querySelector( \".user-redeemed-coupons table\" ),\n        tableTbody   = couponTable.querySelector( \"tbody\" );\n\n    let applyMarkup = \"\";\n\n    if ( acfw_loyalprog_args.is_uc_module && action ) {\n        applyMarkup = `\n            <a class=\"button\" href=\"${ action }\">\n                ${ acfw_loyalprog_args.coupon_apply_text }\n            </a>\n        `;\n    }\n\n    jQuery( tableTbody ).find( \"tr.no-coupon-tr\" ).remove();\n\n    jQuery( tableTbody ).prepend(`\n        <tr class=\"new\">\n            <td class=\"coupon_code\">${ code }</td>\n            <td class=\"coupon_amount\">${ amount }</td>\n            <td class=\"coupon_created\">${ date }</td>\n            <td class=\"actions\">${ applyMarkup }</td>\n        </tr>\n    `);\n\n}\n\n/**\n * AJAX refresh user points.\n * \n * @since 1.9\n */\nfunction ajax_refresh_user_points() {\n\n    jQuery.post( acfw_loyalprog_args.ajaxurl , {\n        action : \"acfw_lp_refresh_user_points\",\n        nonce  : acfw_loyalprog_args.refresh_nonce,\n    } , ( response ) => {\n\n        if ( response.status == \"success\" )\n            refresh_user_points( response.user_points , response.worth , response.expire_msg );\n\n    } , \"json\" );\n}\n\n/**\n * When input field has invalid points value, set button as disabled.\n * \n * @since 1.9\n */\nfunction validate_points_amount() {\n\n    const $this = jQuery(this),\n        $form   = $this.closest( \"#redeem-points-form\" ),\n        $button = $form.find( \"#redeem_submit_field button\" ),\n        val     = parseInt( $this.val() ),\n        min     = parseInt( $this.prop( \"min\" ) ),\n        max     = parseInt( $this.prop( \"max\" ) );\n\n    if ( val !== 0 && val >= min && val <= max )\n        $button.prop( \"disabled\" , false )\n    else\n        $button.prop( \"disabled\" , true );\n}\n\n/**\n * Function to redeem user points.\n * \n * @since 1.9\n */\nfunction user_redeem_points(e) {\n\n    e.preventDefault();\n    const $form  = jQuery(this),\n        formData = $form.serializeArray();\n\n    $form.find( \".input-text,button\" ).prop( \"disabled\" , true );\n    toggle_overlay();\n    \n    jQuery.post( acfw_loyalprog_args.ajaxurl , formData , ( response ) => {\n\n        if ( response.status == \"success\" ) {\n\n            refresh_user_points( response.points , response.worth , response.expire_msg );\n            append_user_coupon( response );\n\n        } else {\n            // TODO: change to vex.\n            alert( response.error_msg );\n        }\n\n        $form.find( \".input-text\" ).val( 0 );\n        $form.find( \".input-text,.button\" ).prop( \"disabled\" , false );\n        toggle_overlay( \"hide\" );\n\n    } , \"json\" );\n}\n\n/**\n * Fix overlay position on window resize and first load.\n * \n * @since 1.9\n */\nfunction fix_overlay_position() {\n\n    const loyalProg = document.querySelector( \"#acfw-loyalty-programs-myaccount\" ),\n        overlay     = loyalProg.querySelector( \".acfw-overlay\" ),\n        leftPadding = jQuery( loyalProg ).offset().left + ( ( jQuery( loyalProg ).width() / 2 ) - 20 );\n    \n    jQuery( overlay ).css( 'backgroundPosition' , `${ leftPadding }px 50%` );\n}\n\n/**\n * Toggle overlay display.\n * \n * @param {string} toggle Hide or show. \n */\nfunction toggle_overlay( toggle = \"show\" ) {\n\n    const loyalProg = document.querySelector( \"#acfw-loyalty-programs-myaccount\" ),\n        overlay     = loyalProg.querySelector( \".acfw-overlay\" ),\n        display     = toggle == \"show\" ? \"block\" : \"none\";\n\n    jQuery( overlay ).css( \"display\" , display );\n}\n\n/***\n * Format money based on parameters.\n * source: https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-dollars-currency-string-in-javascript#149099\n * \n * @since 1.9\n * \n * @param {float}     amount       Amount to format.\n * @param {int}       decimalCount Decimal space count.\n * @param {string}    decimal      Decimal symbol.\n * @param {thousands} thousands    Thousands symbol.\n */\nfunction format_money( amount , decimalCount = 2 , decimal = \".\" , thousands = \",\" ) {\n\n    decimalCount = Math.abs(decimalCount);\n    decimalCount = isNaN(decimalCount) ? 2 : decimalCount;\n\n    const negativeSign = amount < 0 ? \"-\" : \"\";\n\n    let i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();\n    let j = (i.length > 3) ? i.length % 3 : 0;\n\n    return negativeSign + (j ? i.substr(0, j) + thousands : '') + i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousands) + (decimalCount ? decimal + Math.abs(amount - i).toFixed(decimalCount).slice(2) : \"\");\n};\n\n\n// WEBPACK FOOTER //\n// ./src/my_account.js","/* global jQuery */\nimport \"./assets/styles/index.scss\";\nimport { my_account_events } from \"./my_account\";\n\njQuery( document ).ready( function($) {\n\n    my_account_events($);\n});\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}