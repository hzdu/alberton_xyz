!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(e,t,n){"use strict";n.r(t);n(0);function a(e,t){void 0===t&&(t=""),t||(t="show");var n="show"===t?"block":"none";jQuery(e).css("display",n)}function o(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039"};return e.replace(/[&<>"']/g,(function(e){return t[e]}))}function i(){var e=acfw_edit_coupon.decimal_separator,t=jQuery(this),n=t.val()+"";n=="0"+e&&t.val("0"),"0"!=n&&n.substring(0,2)!="0"+e&&(n=(n=n.replace(/^0+/,"")).substring(0,1)==e?"0"+n:n,t.val(n))}function c(e,t,n,a){return void 0===n&&(n="value"),void 0===a&&(a="label"),e.map((function(e){return'<option value="'+e[n]+'" '+(e[n]==t?"selected":"")+">"+e[a]+"</option>"})).toString().replace(/>,</g,"><")}function d(e,t){return e==t?"selected":""}function r(e){void 0===e&&(e="");var t=acfw_edit_coupon.condition_field_options,n=t.exactly,a=t.anyexcept,o=t.morethan,i=t.lessthan;return'\n        <option value="=" '+d(e,"=")+">"+n+'</option>\n        <option value="!=" '+d(e,"!=")+">"+a+'</option>\n        <option value=">" '+d(e,">")+">"+o+'</option>\n        <option value="<" '+d(e,"<")+">"+i+"</option>\n    "}function l(e){var t=acfw_edit_coupon.decimal_separator,n=parseFloat(e.replace(t,"."));return isNaN(n)?0:n}function s(e){var t=e.product_id,n=e.product_label,a=e.condition_label,i=e.quantity;return'\n    <tr>\n        <td class="product" data-product="'+o(JSON.stringify(e))+'" data-product_id="'+t+'">\n            '+n+'\n        </td>\n        <td class="condition">'+a+'</td>\n        <td class="quantity">'+i+'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    '}function u(e){return void 0===e&&(e=4),'\n    <tr class="no-result">\n        <td colspan="'+e+'">'+acfw_edit_coupon.no_products_added+"</td>\n    </tr>\n    "}var p=jQuery,f=acfw_edit_coupon.cart_condition_fields.product_quantity;function _(e){var t=acfw_edit_coupon.add_product_label,n=f.title,a=f.product_col,o=f.condition_col,i=f.quantity_col,c="";if(e.length)for(var d=0,r=e;d<r.length;d++){c+=s(r[d])}else c=u(4);return'\n    <div class="product-quantity-condition-field condition-set"  data-type="product-quantity">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+n+'</h3>\n        <table class="product-quantity-condition-table acfw-styled-table" data-exclude="[]">\n            <thead>\n                <tr>\n                    <th class="product">'+a+'</th>\n                    <th class="condition">'+o+'</th>\n                    <th class="quantity">'+i+'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                '+c+'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            '+t+"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    "}function v(e){var t=e.querySelectorAll(".product-quantity-condition-table tr td.product"),n=[];return t.forEach((function(e){return n.push(p(e).data("product"))})),n}var h=jQuery,b=acfw_edit_coupon.cart_condition_fields.customer_registration_date;function m(e){return'\n    <div class="customer-registration-date-field condition-field" data-type="customer-registration-date">\n\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+b.title+"</h3>\n\n        <label>"+b.desc+'</label>   \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="1" value="'+(e&&e>-1?e:0)+'">\n            <label>'+b.hours+"</label>\n        </div>\n    </div>\n    "}function y(e){return parseInt(h(e).find(".condition-value").val())}var g=jQuery,w=acfw_edit_coupon.cart_condition_fields.customer_last_ordered;function x(e){return'\n    <div class="customer-last-ordered-field condition-field" data-type="customer-last-ordered">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+w.title+"</h3>\n        <label>"+w.desc+'</label>    \n        <div class="field-control side-label">\n            <input class="condition-value" type="number" min="0" value="'+(e&&e>-1?e:0)+'">\n            <label>'+w.hours+"</label>\n        </div>\n    </div>\n    "}function j(e){return parseInt(g(e).find(".condition-value").val())}var k=jQuery,q=acfw_edit_coupon.cart_condition_fields.total_customer_spend;function S(e){var t=e.condition,n=e.value,a=e.offset,o=acfw_edit_coupon.condition_label,i=q.title,c=q.desc,d=q.total_spend,s=q.days_offset,u=n?l(n):0;return'\n    <div class="total-customer-spend-field condition-field" data-type="total-customer-spend">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+i+"</h3>\n        <label>"+c+'</label>\n        <div class="field-control">\n            <label>'+o+'</label>\n            <select class="condition-select">\n                '+r(t)+'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>'+d+'</label>\n            <input class="condition-value wc_input_price" type="text" min="0" value="'+(!isNaN(u)&&u>-1?n:0)+'">\n        </div>\n        <div class="field-control">\n            <label>'+s+'</label>\n            <input class="condition-offset" type="number" min="0" value="'+(a&&a>-1?a:0)+'">\n        </div>\n    </div>\n    '}function z(e){return{condition:k(e).find(".condition-select").val(),value:k(e).find(".condition-value").val(),offset:k(e).find(".condition-offset").val()}}var Q=jQuery,O=acfw_edit_coupon.cart_condition_fields.has_ordered_before;function N(e){void 0===e&&(e={});var t=e.condition,n=e.value,a=e.products,o=acfw_edit_coupon.cart_condition_fields,i=acfw_edit_coupon.add_product_label,c=o.product_quantity,r=c.product_col,l=c.condition_col,p=c.quantity_col,f=o.has_ordered_before,_=f.title,v=f.type,h=f.within_a_period,b=f.number_of_orders,m=f.num_prev_days,y="";if(a&&a.length)for(var g=0,w=a;g<w.length;g++){y+=s(w[g])}else y=u(4);return'\n    <div class="cart-quantity-field condition-field condition-set" data-type="has-ordered-before">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+_+'</h3>\n        <div class="field-control">\n            <label>'+v+'</label>\n            <select class="condition-select has-ordered-before-type">\n                <option value="within-a-period" '+d(t,"within-a-period")+">"+h+'</option>\n                <option value="number-of-orders" '+d(t,"number-of-orders")+">"+b+'</option>\n            </select>\n        </div>\n        <div class="field-control condition-type-value">\n            <label>'+m+'</label>\n            <input class="condition-value" type="number" min="0" value="'+n+'">\n        </div>\n        <table class="has-ordered-before-products-table acfw-styled-table" data-exclude="[]">\n            <thead>\n                <tr>\n                    <th class="product">'+r+'</th>\n                    <th class="condition">'+l+'</th>\n                    <th class="quantity">'+p+'</th>\n                    <th class="actions"></th>\n                </tr>\n            </thead>\n            <tbody>\n                '+y+'\n            </tbody>\n            <tfoot>\n                <tr>\n                    <td colspan="4">\n                        <a class="add-table-row" href="javascript:void(0);">\n                            <i class="dashicons dashicons-plus"></i>\n                            '+i+"\n                        </a>\n                    </td>\n                </tr>\n            </tfoot>\n        </table>\n    </div>\n    "}function I(e){var t=e.querySelectorAll(".has-ordered-before-products-table tr td.product"),n=[];return t.forEach((function(e){return n.push(Q(e).data("product"))})),{condition:Q(e).find(".condition-select").val(),value:parseInt(Q(e).find(".condition-value").val()),products:n}}var P=jQuery,C=acfw_edit_coupon.cart_condition_fields.shipping_zone_region;function J(e){var t=e.value,n=C.title,a=C.zone_label,i=C.zone_placeholder,c=C.regions_label,r=C.regions_placeholder,l=C.zone_options,s=t&&t.length?t:[];return'\n    <div class="shipping-zone-region-field condition-field" data-type="shipping-zone-region"\n        data-zones="'+o(JSON.stringify(l))+'"\n        data-regions="'+o(JSON.stringify(s))+'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+n+'</h3>\n        <div class="field-control">\n            <label>'+a+'</label>\n            <select class="condition-select wc-enhanced-select" data-placeholder="'+o(i)+'">\n                <option value="">'+i+"</option>\n                "+function(e,t){var n=e.condition,a="";for(var o in t){var i=t[o];a+='\n            <option value="'+o+'" '+d(n,o)+">\n                "+i.name+"\n            </option>\n        "}return a}(e,l)+'\n            </select>\n        </div>\n        <div class="field-control regions">\n            <label>'+c+'</label>\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="'+o(r)+'">\n            </select>\n        </div>\n    </div>\n    '}function D(e){return{condition:P(e).find(".condition-select").val(),value:P(e).find(".condition-value").val()}}var M=jQuery,E=acfw_edit_coupon.cart_condition_fields.custom_taxonomy;function W(e){var t=e.condition,n=e.value,a=E.title,i=E.select_taxonomy,c=(E.product_type,E.select_terms),r=n&&n.length?n:[];return'\n    <div class="custom-taxonomy-field condition-field" data-type="custom-taxonomy" \n        data-selected_terms="'+o(JSON.stringify(r))+'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+a+'</h3>\n        <div class="field-control">\n            <select class="condition-select wc-enhanced-select custom-taxonomy" data-placeholder="'+i+'">\n                <option value="">'+i+"</option>\n                "+function(e){for(var t=E.tax_options,n=(E.product_type,""),a=0,o=t;a<o.length;a++){var i=o[a],c=i.name,r=i.label;n+='\n            <option value="'+c+'" '+d(e,c)+">\n                "+r+"\n            </option>\n        "}return n}(t)+'\n            </select>\n        </div>\n        <div class="field-control field-control-wide">\n            <select class="condition-value wc-enhanced-select" multiple data-placeholder="'+c+'">\n            </select>\n        </div>\n    </div>\n    '}function A(e){return{condition:M(e).find(".condition-select").val(),value:M(e).find(".condition-value").val()}}var T=jQuery,F=acfw_edit_coupon.cart_condition_fields,B=F.custom_user_meta,H=F.custom_cart_item_meta;function R(e,t){var n=e.condition,a=e.key,o=e.value,i=e.type,c=acfw_edit_coupon.condition_label,l=F[t],s=l.title,u=l.meta_key,p=l.meta_value,f=l.value_type,_=t.replace(/_/g,"-");return'\n    <div class="'+_+'-field condition-field" data-type="'+_+'">\n        <a class="remove-condition-field" href="javascript:void(0);"><i class="dashicons dashicons-trash"></i></a>\n        <h3 class="condition-field-title">'+s+'</h3>\n        <div class="field-control wider">\n            <label>'+f+'</label>\n            <select class="value-type">\n                '+function(e,t){var n=F[t].type_options,a="";for(var o in n){var i=n[o];a+='<option value="'+o+'" '+d(e,o)+">"+i+"</option>"}return a}(i,t)+'\n            </select>\n        </div>\n        <div class="field-control">\n            <label>'+c+'</label>\n            <select class="condition-select">\n                '+r(n)+'\n            </select>\n        </div>\n        <div class="field-control wider">\n            <label>'+u+'</label>\n            <input class="condition-key" type="text" value="'+(a||"")+'">\n        </div>\n        <div class="field-control wider">\n            <label>'+p+'</label>\n            <input class="condition-value" type="text" value="'+(o||o>-1?o:"")+'">\n        </div>\n    </div>\n    '}function X(e){return{condition:T(e).find(".condition-select").val(),key:T(e).find(".condition-key").val(),value:T(e).find(".condition-value").val(),type:T(e).find(".value-type").val()}}var G=jQuery;function K(){var e=document.querySelector("#acfw_cart_conditions");f.default_data_value={},f.template_callback=_,f.scraper_callback=v,b.template_callback=m,b.scraper_callback=y,w.template_callback=x,w.scraper_callback=j,q.default_data_value={},q.template_callback=S,q.scraper_callback=z,O.default_data_value={},O.template_callback=N,O.scraper_callback=I,C.default_data_value={},C.template_callback=J,C.scraper_callback=D,E.default_data_value={},E.template_callback=W,E.scraper_callback=A,B.default_data_value={},B.template_callback=R,B.scraper_callback=X,H.default_data_value={},H.template_callback=R,H.scraper_callback=X,G(e).on("change","input.condition-value",L)}function L(){var e=G(this);if("number"===e.closest(".condition-field").find("select.value-type").val()){var t=parseInt(e.val()+"");e.val(isNaN(t)?"":Math.round(t))}}var U=jQuery,V=document.querySelector("#acfw_add_products");function Y(e){U(V).data("editing",e),U(V).find("#save-add-products").prop("disabled",!e)}function Z(e,t){void 0===e&&(e=[]),void 0===t&&(t=!1);var n=t.discount_type,a=t.discount_value,i=acfw_edit_coupon.product_table_buttons,c=i.edit,r=i.add,s=i.cancel,u=acfw_edit_coupon.bogo_form_fields.type_to_search,p="object"==typeof t?function(e){var t=e.product_id,n=e.product_label;return'<option value="'+t+'">'+n+"</option>"}(t):"",f="object"==typeof t?c:r,_=a&&l(a)>=0&&"nodiscount"!==n?a:"";return'\n    <tr class="add-edit-form adding">\n        <td class="product" data-object="'+("object"==typeof t?o(JSON.stringify(t)):0)+'">\n            <div class="object-search-wrap">\n                <select class="product-in-cart wc-product-search"\n                    data-placeholder="'+u+'"\n                    data-action="acfwp_add_products_search"\n                    data-exclude="'+o(JSON.stringify(e))+'">'+p+'</select>\n            </div>\n        </td>\n        <td class="quantity">\n            <input type="number" class="condition-quantity" value="'+("object"==typeof t?t.quantity:1)+'" min="1">\n        </td>\n        <td class="price">\n            <div>\n            <select class="discount_type">\n                '+function(e,t){void 0===e&&(e=""),void 0===t&&(t=!1);var n=acfw_edit_coupon.currency_symbol,a=acfw_edit_coupon.discount_field_options,o=a.nodiscount,i=a.override,c=a.percent,r=a.fixed,l='<option value="nodiscount" '+d(e,"nodiscount")+">= : "+o+"</option>";return"\n        "+(t?l:"")+'\n        <option value="override" '+d(e,"override")+">"+n+" : "+i+'</option>\n        <option value="percent" '+d(e,"percent")+">% : "+c+'</option>\n        <option value="fixed" '+d(e,"fixed")+">-"+n+" : "+r+"</option>\n    "}(n,!0)+'\n            </select>\n            <input type="text" class="discount_value short wc_input_price" value="'+_+'">\n            </div>\n        </td>\n        <td class="actions">\n            <button type="button" class="condition-product-add button-primary">'+f+'</button>\n            <button type="button" class="cancel button">'+s+"</button>\n        </td>\n    </tr>\n    "}function $(e){var t=e.product_id,n=e.product_label,a=e.quantity,i=e.discount_type,c=e.discount_value,d="nodiscount"!==i?c:"";return'\n    <tr>\n        <td class="product product-'+t+' object" data-product="'+o(JSON.stringify(e))+'">\n            '+n+'\n        </td>\n        <td class="quantity">'+a+'</td>\n        <td class="price">('+i+") "+d+'</td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0)"><span class="dashicons dashicons-edit"></span></a>\n            <a class="remove" href="javascript:void(0)"><span class="dashicons dashicons-no"></span></a>\n        </td>\n    </tr>\n    '}function ee(e){return void 0===e&&(e=4),'\n    <tr class="no-result">\n        <td colspan="'+e+'">'+acfw_edit_coupon.no_products_added+"</td>\n    </tr>\n    "}var te=jQuery;function ne(){var e=te(this).closest(".acfw-styled-table"),t=e.find("tbody"),n=e.data("exclude");t.find("tr.no-result").remove(),t.append(Z(n)),t.find("select.discount_type").trigger("change"),t.find("select.wc-product-search").trigger("change"),te("body").trigger("wc-enhanced-select-init")}function ae(){var e=jQuery(this),t=e.closest("tr"),n=e.closest(".acfw-styled-table"),a=n.find("tbody"),o=t.find(".product").data("product"),i=o.product_id,c=n.data("exclude");(c="object"==typeof c?c:[]).splice(c.indexOf(i),1),a.find("tr.no-result").remove(),t.replaceWith(Z(c,o)),a.find("select.discount_type").trigger("change"),a.find("select.wc-product-search").trigger("acfw_product_select"),n.data("exclude",c),n.find("select.wc-product-search").data("exclude",c),te("body").trigger("wc-enhanced-select-init")}function oe(){var e=acfw_edit_coupon.fill_form_propery_error_msg,t=jQuery(this),n=t.closest("tr"),a=t.closest("table.acfw-styled-table"),o=n.find(".wc-product-search"),i=n.find(".condition-quantity"),c=n.find("select.discount_type").val().toString(),d=n.find("input.discount_value").val().toString(),r=a.data("exclude"),s=parseInt(n.find(".wc-product-search").val().toString()),u={product_id:s,quantity:parseInt(n.find(".condition-quantity").val().toString()),product_label:n.find(".wc-product-search option:selected").text(),discount_type:c,discount_value:d};!o.val()||!i.val()||i.val()<1||"nodiscount"!==c&&(isNaN(l(d))||l(d)<0)?vex.dialog.alert(e):((r="object"==typeof r?r:[]).push(s),n.replaceWith($(u)),a.data("exclude",r),a.find(".wc-product-search").data("exclude",r),Y(!0))}function ie(){var e=jQuery(this),t=e.closest("tr"),n=e.closest("table"),a=t.closest("tbody"),o=t.find("td").length,i=t.find("td.product").data("object"),c=n.data("exclude");"object"==typeof i?((c="object"==typeof c?c:[]).push(i.product_id),t.replaceWith($(i)),n.data("exclude",c),n.find(".wc-product-search").data("exclude",c)):(t.remove(),a.find("tr").length<=0&&a.html(ee(o)))}function ce(){var e=jQuery(this).closest("tr"),t=e.closest("table"),n=e.closest("tbody"),a=e.find("td").length,o=e.find("td.object").data("product"),i=t.data("exclude"),c=i.indexOf(parseInt(o.product_id));-1!==c&&i.splice(c,1),t.data("exclude",i),t.find(".wc-product-search").data("exclude",i),e.remove(),n.find("tr").length<=0&&n.html(ee(a)),Y(!0)}var de=jQuery,re=woocommerce_admin_meta_boxes.post_id,le=document.querySelector("#acfw_add_products"),se=le?le.querySelector(".acfw-overlay"):null;function ue(){de("#acfw_bogo_deals").find(".acfw-styled-table tr.add-edit-form button.cancel").trigger("click");var e,t=acfw_edit_coupon.post_status,n=le.querySelectorAll("table.acfw-styled-table tbody td.object"),o=le.querySelector(".add-before-cart-condition-check-field input[type='checkbox']"),i=[];n.forEach((function(t){(e=de(t).data("product"))&&i.push(e)})),a(se,"show"),de.post(ajaxurl,{action:"acfw_save_add_products_data",coupon_id:re,products:i,add_before_conditions:de(o).is(":checked")?1:0},(function(e){"success"==e.status?"publish"!==t&&(de("input[name='post_title']").val()||de("input[name='post_title']").val("coupon-"+re),de("select[name='post_status']").append(new Option("Published","publish")).val("publish"),de("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),de("input#publish").click()):e.error_msg&&(vex.dialog.alert(e.error_msg),console.log(e),de(le).addClass("save-error")),de(le).find("button#clear-add-products").prop("disabled",!1),Y(!1),a(se,"hide")}),"json")}function pe(){var e=de(this);if(confirm(e.data("prompt"))){var t=le.querySelector("table.acfw-styled-table tbody");a(se,"show"),de.post(ajaxurl,{action:"acfw_clear_add_products_data",coupon_id:re,_wpnonce:e.data("nonce")},(function(n){"success"==n.status?(de(t).html(ee(4)),e.prop("disabled",!0),Y(!1),"Published"!=de("#post-status-display").text()&&(de("input[name='post_title']").val()||de("input[name='post_title']").val("coupon-"+re),de("input#publish").click())):(n.error_msg&&vex.dialog.alert(n.error_msg),console.log(n)),a(se,"hide")}),"json")}}function fe(e){de(".coupon_data_tabs").find(".acfw_add_products_tab").hasClass("active")&&de(le).data("editing")&&(e.preventDefault(),de(le).find("#save-add-products").trigger("click"),setTimeout((function(){de(le).hasClass("save-error")?de(le).removeClass("save-error"):de("form#post").submit()}),1e3))}var _e=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],c=0,d=i.length;c<d;c++,o++)a[o]=i[c];return a},ve=jQuery,he=document.querySelector("#acfw_add_products");function be(e){void 0===e&&(e=jQuery),e(he).on("click",".acfw-styled-table tfoot .add-table-row",ne),e(he).on("click",".acfw-styled-table td.actions a.edit",ae),e(he).on("click","tr.add-edit-form .actions .condition-product-add",oe),e(he).on("click","tr.add-edit-form .actions .cancel",ie),e(he).on("click",".acfw-styled-table td.actions a.remove",ce),e(he).on("click","button#save-add-products",ue),e(he).on("click","button#clear-add-products",pe),e(he).on("change","select.discount_type",me),e(he).on("blur",".wc_input_price",i),e("form#post").on("submit",fe),e(he).css("min-height",e("#coupon_options").height()),e(he).on("click",".acfw-styled-table .actions .remove",(function(){return Y(!0)})),e(he).on("change","input[name='add_before_cart_condition']",(function(){return Y(!0)})),function(){var e=ve(he).data("products"),t=ve(he).find(".add-products-data-table tbody");if(e.length>0){var n="";e.forEach((function(e){n+=$(e)})),t.html(n)}else t.html(ee(4))}(),e(document).ajaxComplete(ye),e(he).on("change","select.discount_type",ge)}function me(){var e=ve(this);e.closest("tr").find(".discount_value").prop("disabled","nodiscount"===e.val())}function ye(e,t){var n=t.getResponseHeader("X-Subscription-IDs");if(n){var a=ve(he).data("subscription_ids")||[],o=n.split(",").map((function(e){return parseInt(e)}));ve(he).data("subscription_ids",_e(a,o).filter((function(e,t,n){return n.indexOf(e)===t})))}}function ge(){var e=ve(he).data("subscription_ids")||[];if(e.length){var t=ve(this),n=t.closest("tr").find("select.wc-product-search"),a=parseInt(n.val());e.includes(a)&&"nodiscount"!==t.val()&&(vex.dialog.alert(ve(he).data("subscription_discount_error")),t.val("nodiscount"),t.trigger("change"))}}var we=jQuery;function xe(){var e=we("#customer_email"),t=parseInt(we("#usage_limit").val()),n=parseInt(we("#usage_limit_per_user").val()),a=we("#acfw_auto_apply_coupon_field"),o=we("#acfw-auto-apply-coupon .auto-apply-warning");(e.val()||t||n)&&a.prop("checked")?o.show():o.hide()}var je=jQuery;function ke(){var e=je(this),t=e.closest("tr"),n=t.find(".select-shipping-method"),a=t.closest(".acfw-styled-table"),o=(a.data("exclude"),(a.data("zonemethods")||[]).filter((function(t){return t.zone_id==e.val()}))),i=o.length?o[0].methods:[];n.empty(),i.length&&(i.map((function(e){return n.append(new Option(e.label,e.value))})),n.trigger("change"))}var qe=jQuery,Se=document.querySelector("#acfw_shipping_overrides");function ze(e){qe(Se).data("editing",e),qe(Se).find("#save-shipping-overrides").prop("disabled",!e)}function Qe(e){return'\n        <tr class="no-result">\n            <td colspan="'+e+'">'+acfw_edit_coupon.no_shipping_overrides_added+"</td>\n        </tr>\n    "}var Oe=jQuery,Ne=document.querySelector("#acfw_shipping_overrides"),Ie=woocommerce_admin_meta_boxes.post_id;function Pe(){var e=acfw_edit_coupon.post_status,t=acfw_edit_coupon.no_shipping_overrides_save,n=Ne.querySelector(".acfw-overlay"),o=Oe(this),i=Ne.querySelectorAll(".shipping-overrides-table tbody tr td.object"),c=[];i.forEach((function(e){c.push(Oe(e).data("object"))})),c.length?(a(n,"show"),o.prop("disabled",!0),Oe.post(ajaxurl,{action:"acfw_save_shipping_overrides",coupon_id:Ie,overrides:c},(function(t){"success"==t.status?"publish"!==e&&(Oe("input[name='post_title']").val()||Oe("input[name='post_title']").val("coupon-"+Ie),Oe("select[name='post_status']").append(new Option("Published","publish")).val("publish"),Oe("#publishing-action").append('\n                    <input type="hidden" name="publish" value="Publish">\n                '),Oe("input#publish").click()):(t.error_msg&&vex.dialog.alert(t.error_msg),console.log(t)),Oe(Ne).find("#clear-shipping-overrides").prop("disabled",!1),ze(!1),a(n,"hide")}),"json")):vex.dialog.alert(t)}function Ce(){var e=Oe(this);if(confirm(e.data("prompt"))){var t=Oe(Ne.querySelector("table.acfw-styled-table")),n=t.find("tbody"),o=Ne.querySelector(".acfw-overlay");a(o,"show"),Oe.post(ajaxurl,{action:"acfw_clear_shipping_overrides",coupon_id:woocommerce_admin_meta_boxes.post_id,_wpnonce:e.data("nonce")},(function(i){if("success"==i.status){var c=t.find("thead tr th").length;n.html(""),n.find("tr").length<=0&&n.append(Qe(c)),t.data("exclude",[]),e.prop("disabled",!0),ze(!1),"Published"!=jQuery("#post-status-display").text()&&(jQuery("input[name='post_title']").val()||jQuery("input[name='post_title']").val("coupon-"+Ie),jQuery("input#publish").click())}else i.error_msg&&vex.dialog.alert(i.error_msg),console.log(i);a(o,"hide")}),"json")}}function Je(e){Oe(Ne).data("editing")&&(e.preventDefault(),Oe(Ne).find("#save-shipping-overrides").trigger("click"),Oe("form#post").off("submit",Je),setTimeout((function(){Oe("form#post").submit()}),1e3))}var De=jQuery,Me=document.querySelector("#acfw_shipping_overrides");function Ee(e){void 0===e&&(e={});var t=acfw_edit_coupon.product_table_buttons,n=t.add,a=t.edit,i=t.cancel,r=e.shipping_zone,s=e.discount_type,u=e.discount_value,p=De(Me).find(".shipping-overrides-table").data("zonemethods")||[],f=p.map((function(e){return{value:e.zone_id,label:e.zone_name}})),_=u&&l(u)>=0?u:"",v=r>=0||"nozone"===r?a:n;return'\n        <tr class="add-edit-form fresh">\n            <td class="shipping-zone" data-object="'+o(JSON.stringify(e))+'">\n                <div>\n                    <select class="select-shipping-zone wc-enhanced-select" data-placeholder="Select shipping zone">\n                    '+c(f,r)+'\n                    </select>\n                </div>\n            </td>\n            <td class="shipping-method">\n                <div>\n                    <select class="select-shipping-method wc-enhanced-select" data-placeholder="Select shipping method">\n                        '+function(e,t){var n=t.shipping_zone,a=t.shipping_method;if("nozone"===n&&a||n>=0&&a){var o=e.filter((function(e){return e.zone_id==n}));return c(o.length?o[0].methods:[],a)}return c(e.length?e[0].methods:[],a)}(p,e)+'\n                    </select>\n                </div>\n            </td>\n            <td class="discount">\n                <select class="discount-type">\n                    '+function(e){void 0===e&&(e="");var t=acfw_edit_coupon.currency_symbol,n=acfw_edit_coupon.discount_field_options,a=n.override,o=n.percent,i=n.fixed;return'\n        <option value="percent" '+d(e,"percent")+">% : "+o+'</option>\n        <option value="fixed" '+d(e,"fixed")+">-"+t+" : "+i+'</option>\n        <option value="override" '+d(e,"override")+">"+t+" : "+a+"</option>\n    "}(s)+'\n                </select>\n                <input type="text" class="discount_value short wc_input_price" value="'+_+'">\n            </td>\n            <td class="actions">\n                <button type="button" class="add button-primary">'+v+'</button>\n                <button type="button" class="cancel button">'+i+"</button>\n            </td>\n        </tr>\n    "}var We=jQuery,Ae=document.querySelector("#acfw_shipping_overrides");function Te(e){var t=e.shipping_zone,n=e.discount_type,a=e.discount_value,i=e.shipping_method,c=(We(Ae).find(".shipping-overrides-table").data("zonemethods")||[]).filter((function(e){return e.zone_id==t}));if(c.length){var d=c[0],r=d.zone_name,l=d.methods.filter((function(e){return e.value==i}));if(l.length)return'\n    <tr>\n        <td class="shipping-zone object" data-object="'+o(JSON.stringify(e))+'">\n            '+r+'\n        </td>\n        <td class="shipping-method">\n            '+l[0].label+'\n        </td>\n        <td class="discount">\n            ('+n+") "+a+'\n        </td>\n        <td class="actions">\n            <a class="edit" href="javascript:void(0);">\n                <span class="dashicons dashicons-edit"></span>\n            </a>\n            <a class="remove" href="javascript:void(0);">\n                <span class="dashicons dashicons-no"></span>\n            </a>\n        </td>\n    </tr>\n    '}}var Fe=jQuery;function Be(){var e=Fe(this).closest(".acfw-styled-table"),t=e.find("tbody");e.data("exclude");t.find("tr.no-result").remove(),t.append(Ee()),Fe("body").trigger("wc-enhanced-select-init"),function(e){var t=e.find(".select-shipping-zone"),n=t.find("option:first");e.removeClass("fresh"),t.val(n.prop("value")),t.trigger("change")}(e.find("tr.add-edit-form.fresh"))}function He(){var e=acfw_edit_coupon.fill_form_propery_error_msg,t=acfw_edit_coupon.shipping_zone_already_added,n=Fe(this).closest("tr"),a=n.closest(".acfw-styled-table"),o=parseInt(n.find(".select-shipping-zone").val()+""),i=n.find(".select-shipping-method").val()+"";o=o>=0&&!isNaN(o)?o:"nozone";var c=a.data("exclude");if(!(o<0)&&i||"nozone"===o&&i)if(c.filter((function(e){return e.zone==o&&e.method==i})).length)vex.dialog.alert(t);else{var d={shipping_zone:o,shipping_method:i,discount_type:n.find(".discount-type").val(),discount_value:n.find(".discount_value").val()};n.replaceWith(Te(d)),c.push({zone:o,method:i}),a.data("exclude",c),ze(!0)}else vex.dialog.alert(e)}function Re(){var e=jQuery(this),t=e.closest("tr"),n=e.closest(".acfw-styled-table"),a=n.find("tbody"),o=t.find(".shipping-zone").data("object"),i=n.data("exclude")||[];i=i.filter((function(e){return e.zone!=o.shipping_zone||e.method!=o.shipping_method})),a.find("tr.no-result").remove(),t.replaceWith(Ee(o)),n.data("exclude",i),Fe("body").trigger("wc-enhanced-select-init")}function Xe(){var e=jQuery(this),t=e.closest("tr"),n=e.closest("table"),a=t.closest("tbody"),o=t.find("td").length,i=t.find("td.shipping-zone").data("object"),c=n.data("exclude");c=c.filter((function(e){return e.zone!=i.shipping_zone||e.method!=i.shipping_method})),n.data("exclude",c),t.remove(),a.find("tr").length<=0&&a.append(Qe(o)),ze(!0)}function Ge(){var e=jQuery(this),t=e.closest("tr"),n=e.closest("table"),a=t.closest("tbody"),o=t.find("td").length,i=t.find("td.shipping-zone").data("object"),c=i.shipping_zone,d=i.shipping_method,r=n.data("exclude");"nozone"===c&&d||c>=0&&d?(r.push({zone:c,method:c}),t.replaceWith(Te(i)),n.data("exclude",r)):(t.remove(),a.find("tr").length<=0&&a.append(Qe(o)))}var Ke=jQuery,Le=document.querySelector("#acfw_shipping_overrides");function Ue(){Ke(Le).on("click",".acfw-styled-table tfoot .add-table-row",Be),Ke(Le).on("change","tr.add-edit-form .select-shipping-zone",ke),Ke(Le).on("click","tr.add-edit-form .actions .add",He),Ke(Le).on("click","tr .actions .edit",Re),Ke(Le).on("click","tr .actions .remove",Xe),Ke(Le).on("click","tr.add-edit-form .actions .cancel",Ge),Ke(Le).on("blur",".wc_input_price",i),Ke(Le).on("click","#save-shipping-overrides",Pe),Ke(Le).on("click","#clear-shipping-overrides",Ce),Ke("form#post").on("submit",Je),Ke(Le).css("min-height",Ke("#coupon_options").height()),function(){var e=Ke(Le).find(".shipping-overrides-table"),t=e.find("tbody"),n=e.data("overrides");if(!n.length)return;t.find("tr.no-result").remove(),n.forEach((function(e){t.append(Te(e))}))}()}var Ve=jQuery,Ye=!1;function Ze(){var e=Ve(this),t=e.closest(".date-time-field"),n=t.find("input.date-hour"),a=t.find("input.date-minute");e.val()&&(n.val()||n.val("00"),a.val()||a.val("00"))}function $e(){var e=Ve(this),t=e.val().toString(),n=parseInt(t);if(!t||n>23||n<0){var a=e.closest(".date-time-field").data("hour");e.val(a||"")}else e.val(("0"+t).slice(-2))}function et(){var e=Ve(this),t=e.val().toString(),n=parseInt(t);if(!t||n>59||n<0){var a=e.closest(".date-time-field").data("hour");e.val(a||"")}else e.val(("0"+t).slice(-2))}function tt(e){var t;try{t=Ve.datepicker.parseDate("yy-mm-dd",e.value)}catch(e){t=null,console.log(e)}return t}function nt(){if(!Ye){Ye=!0;var e=document.querySelector("#acfw_scheduler"),t=e.querySelector("._acfw_schedule_start_field .date-time-field"),n=e.querySelector("._acfw_schedule_expire_field .date-time-field"),a=Ve(t).find(".date-field").val(),o=Ve(n).find(".date-field").val();if(a&&o&&a===o){var i=at(Ve(t)),c=at(Ve(n));if(i>=0&&c>=0&&i>=c)return Ve(t).find(".date-field").val(Ve(t).data("date")),Ve(t).find(".date-hour").val(Ve(t).data("hour")),Ve(t).find(".date-minute").val(Ve(t).data("minute")),Ve(n).find(".date-field").val(Ve(n).data("date")),Ve(n).find(".date-hour").val(Ve(n).data("hour")),Ve(n).find(".date-minute").val(Ve(n).data("minute")),void vex.dialog.alert({unsafeMessage:acfw_edit_coupon.invalid_scheduler_time,afterClose:function(){return Ye=!1}})}Ve(t).data("date",Ve(t).find(".date-field").val()).data("hour",Ve(t).find(".date-hour").val()).data("minute",Ve(t).find(".date-minute").val()),Ve(n).data("date",Ve(n).find(".date-field").val()).data("hour",Ve(n).find(".date-hour").val()).data("minute",Ve(n).find(".date-minute").val()),Ye=!1}}function at(e){return e.find(".date-hour").val()&&e.find(".date-minute").val()?(60*parseInt(e.find(".date-hour").val())*60||0)+(60*parseInt(e.find(".date-minute").val())||0):-1}function ot(){var e=Ve(this).closest(".date-time-field"),t=e.find(".date-field"),n=e.find(".date-hour"),a=e.find(".date-minute");t.val()||n.val()||a.val()?(t.prop("required",!0),n.prop("required",!0),a.prop("required",!0)):(t.prop("required",!1),n.prop("required",!1),a.prop("required",!1))}function it(){var e=document.querySelector("#acfw_scheduler"),t=e.querySelector("#_acfw_schedule_start"),n=e.querySelector("#_acfw_schedule_expire");Ve(this).siblings(".date-time-field").find("input").prop("required",!1).val(""),Ve(t).trigger("change"),Ve(n).trigger("change")}var ct=jQuery,dt=acfw_edit_coupon.bogo_toggle_editing_mode,rt=woocommerce_admin_meta_boxes.post_id;function lt(){var e=ct(this),t=e.closest("#acfw_bogo_deals").find(".bogo-auto-add-products-field"),n=t.find("input[type='checkbox']");"specific-products"===e.val()?(n.prop("disabled",!1),t.addClass("show")):(n.prop("disabled",!1),t.removeClass("show"))}function st(){var e=ct(this).find("select#bogo-deals-type"),t=ct(this).find(".bogo-auto-add-products-field input[type='checkbox']");"specific-products"===e.val()&&ct.post(ajaxurl,{action:"acfw_save_bogo_additional_settings",coupon_id:rt,auto_add_products:t.is(":checked")?"yes":"no"})}var ut=document.querySelector(".acfw-sort-coupon-priority-field"),pt=jQuery;function ft(){var e=pt(this),t=pt(ut).find("input#_acfw_coupon_sort_priority"),n=e.val().toString();switch(n){case"0":case"1":case"10":case"30":case"50":case"90":t.hide(),t.val(n);break;case"custom":default:t.show(),t.val(pt(ut).data("value"))}}function _t(){var e=pt(this),t=parseInt(e.val());(isNaN(t)||1>t)&&(vex.dialog.alert(acfw_edit_coupon.coupon_sort_invalid),e.val(""))}var vt=acfw_edit_coupon.modules;jQuery(document).ready((function(e){var t,n,a,o,i;vt.indexOf("acfw_cart_conditions_module")>-1&&K(),vt.indexOf("acfw_add_free_products_module")>-1&&be(),vt.indexOf("acfw_auto_apply_module")>-1&&(we("body").on("change","#customer_email,#acfw_auto_apply_coupon_field,#usage_limit,#usage_limit_per_user",xe),we("#customer_email,#acfw_auto_apply_coupon_field").trigger("change")),vt.indexOf("acfw_shipping_overrides_module")>-1&&Ue(),vt.indexOf("acfw_scheduler_module")>-1&&(t=document.querySelector("#acfw_scheduler"),n=t.querySelector("#_acfw_schedule_start"),a=t.querySelector("#_acfw_schedule_expire"),o=document.querySelector("#general_coupon_data p.expiry_date_field"),Ve(t).on("change",".date-field",Ze),Ve(t).on("change",".date-hour",$e),Ve(t).on("change",".date-minute",et),Ve(t).on("change",".date-field,.date-hour,.date-minute",nt),Ve(t).on("change",".date-field,.date-hour,.date-minute",ot),Ve(t).on("click",".clear-scheduler-fields",it),Ve(o).css("display","none"),Ve(n).datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,maxDate:tt(a)}).on("change",(function(){Ve(a).datepicker("option","minDate",tt(n))})),Ve(a).datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0,minDate:tt(n)}).on("change",(function(){return Ve(n).datepicker("option","maxDate",tt(a))})),Ve(n).trigger("change"),Ve(a).trigger("change")),vt.indexOf("acfw_bogo_deals_module")>-1&&(i=document.querySelector("#acfw_bogo_deals"),ct(i).on("change","select#bogo-deals-type",lt),ct(i).on("change",".bogo-auto-add-products-field input[type='checkbox']",(function(){return dt(!0)})),ct(i).on("save_bogo_deals",st)),vt.indexOf("acfw_sort_coupons_module")>-1&&(pt(ut).on("change","select#_acfw_coupon_sort_select",ft),pt(ut).on("change","input#_acfw_coupon_sort_priority",_t),pt(ut).find("select#_acfw_coupon_sort_select").trigger("change"))}))}]);
//# sourceMappingURL=edit-advanced-coupon.js.map