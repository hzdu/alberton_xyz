!function(d,c,n){var t=null,p=(UR_Snackbar?t=new UR_Snackbar:n&&console.warn('URCR: "UR_Snackbar" is not defined. Maybe there was a problem while enqueuing the script.'),d(function(){i.init(),l.init(),s.init(),a.init(),p.init_all_flatpickr(),p.init_all_tooltips(),e.render_access_rule(),p.toggleSaveButtons(!1),d(".user-registration-editable-title__icon").trigger("click"),d(".user-registration-editable-title__input").trigger("select"),d(document.body).on("click",".urcr-save-rule",function(e){e.preventDefault(),e.stopPropagation(),c.rule_id&&""!==c.rule_id?r.save_rule():r.create_rule()}),d(document.body).on("click",".urcr-save-rule-as-draft",function(e){e.preventDefault(),e.stopPropagation(),r.save_rule_as_draft()}),d(document.body).on("submit",".urcr-content-access-rule-creator-form",function(e){e.preventDefault(),e.stopPropagation()}),d(document.body).trigger("urcr_initializations_complete")}),{if_empty:function(e,t){return null===e||undefined===e||""===e?t:e},if_not_object:function(e,t){return null===e||undefined===e||"object"!=typeof e?t:e},if_not_json_object:function(e,t){return null===e||undefined===e||Array.isArray(e)||"object"!=typeof e?t:e},if_not_array:function(e,t){return null!==e&&undefined!==e&&Array.isArray(e)?e:t},init_all_tooltips:function(){d(".user-registration-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200,keepAlive:!0})},init_all_enhanced_select:function(){var t=!1;d(".urcr-enhanced-select2").each(function(){var e=d(this).data("select2_class");d(this).select2({containerCssClass:e}).on("select2:selecting",function(){t=!0}).on("select2:unselecting",function(){t=!0}).on("select2:closing",function(){if(t&&this.multiple)return t=!1})})},init_all_flatpickr:function(){d(".urcr-flatpickr").each(function(){p.init_a_flatpickr(d(this))})},init_a_flatpickr:function(e){var t=(e="string"==typeof e&&""!==e?d(e):e).data("mode"),a=!0===e.data("enable-time"),r=!0===e.data("no-calendar");value=e.val(),e.flatpickr({mode:t,enableTime:a,noCalender:r,defaultDate:value||""})},create_switch_tag:function(e){var t='<div class="'+e.divClassName+'">';return(t+='<input id="'+e.id+'" type="checkbox" class="'+e.inputClassName+'" '+e.default_checked+"  "+e.disabled+">")+('<label class="'+e.labelClassName+'" for="'+e.id+'"> '+e["default"]+" </label>")+"</div>"},create_select_tag:function(e){var t=e.id?'id="'+e.id+'"':"",a=e.className||"",r=e.multiple?'multiple="multiple"':"",n="",i=e.options&&"object"==typeof e.options?e.options:{},c=e.data&&"object"==typeof e.data?e.data:{},o="",l=!0===e.prepend_empty_option?"<option></option>":"",s=e.attr&&"object"==typeof e.attr?e.attr:{},u="",_=e.style&&"string"==typeof e.style?'style="'+e.style+'"':"",d=e.value||"",p="";return Object.keys(s).forEach(function(e){u+=e+'="'+s[e]+'" '}),Object.keys(c).forEach(function(e){o+="data-"+e+'="'+c[e]+'" '}),n="<select "+t+' class="'+a+'" '+r+" "+o+" "+u+" "+_+">"+l,Object.keys(i).forEach(function(e){p=Array.isArray(d)&&d.includes(e)||d===e?'selected="selected"':"",n+='<option value="'+e+'" '+p+">"+i[e]+"</option>"}),n+="</select>"},generate_unique_string:function(e){return(e=p.if_empty(e,"x"))+(new Date).getTime()},resolve_smart_tags:function(t,a,e){var r;return e=p.if_not_array(e,[]),t&&a&&"object"==typeof a&&Object.keys(a).forEach(function(e){r=new RegExp("{{{"+e+"}}}","g"),t=t.replace(r,a[e])}),e&&Array.isArray(e)&&e.length&&e.forEach(function(e){e&&"object"==typeof e&&e.placeholder&&""!==e.placeholder?(r=new RegExp("{{{"+e.placeholder+":"+e.tag+"}}}","g"),t=t.replace(r,e.value),r=new RegExp("{{{"+e.placeholder+":[A-z0-9_]+}}}","g"),t=t.replace(r,"")):n&&console.warn("URCR: Invalid smart tag variable",e)}),t},show_success_message:function(e){return!!t&&(t.add({type:"success",message:e,duration:5}),!0)},show_failure_message:function(e){return!!t&&(t.add({type:"failure",message:e,duration:6}),!0)},insert_template:function(e,t,a,r){a=p.if_not_json_object(a,{}),r=p.if_not_array(r,[]),e&&e.append&&(a.ID&&!0===a.ID&&(a.ID=p.generate_unique_string()),t=p.resolve_smart_tags(t,a,r),e.append(t))},append_spinner:function(e){return!(!e||!e.append)&&(e.append('<span class="ur-spinner is-active"></span>'),!0)},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".ur-spinner").remove(),!0)},updateBrowserLocationURL:function(){var e;!c.rule_id||(e=new URLSearchParams(window.location.search)).get("post-id")&&e.get("post-id")===c.rule_id.toString()||(e["delete"]("post-id"),e.set("post-id",c.rule_id),window.history.pushState({},"",window.location.origin+window.location.pathname+"?"+e.toString()))},toggleSaveButtons:function(e){e=p.if_empty(e,!0),d(".urcr-save-rule").prop("disabled",!!e),d(".urcr-save-rule-as-draft").prop("disabled",!!e)},validate_access_rule_form:function(e){var t=d(".urcr-content-access-rule-title-input").val().trim(),a={result:!0};return e=p.if_empty(e,!0),t&&""!==t||(a.result=!1,a.message=c.labels.title_is_required),e&&!a.result&&this.show_failure_message(a.message),a}}),o={extract_rule_data:function(e){return{enabled:d("#urcr-enable-access-rule").is(":checked"),logic_map:this.extract_conditional_logic_map(e.find(".urcr-conditional-logic-map-container > .urcr-conditional-logic-item")),target_contents:this.extract_target_contents(e),actions:this.extract_rule_actions()}},extract_conditional_logic_map:function(e,t){var a,r,n=e.data("type"),i=e.data("store-id"),c={};return t=p.if_empty(t,!1),e&&e instanceof jQuery&&(!t||i&&""!==i||(i=p.generate_unique_string()),n&&""!==n&&(c="group"===n?(t=e.children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions").children(".urcr-conditional-logic-item"),a=[],r=e.find(".urcr-logic-gate-"+i+".is-active").data("value"),t.each(function(){a.push(o.extract_conditional_logic_map(d(this)))}),{type:"group",id:i,logic_gate:r,conditions:a}):"user_state"===n?{type:n,id:i,value:(t=e.find(".urbg-item-"+i+".is-active")).length?t.data("value"):null}:{type:n,id:i,value:e.find("select, input").val()})),c},extract_target_contents:function(e,t){var a,r,n,i=[];return t=p.if_empty(t,!0),e&&e instanceof jQuery&&($targets=e.find(".urcr-target-content")).length&&$targets.each(function(){n=d(this).data("store-id"),r=d(this).find(".urcr-content-target-input").val(),a=d(this).data("type"),n&&""!==n||!t||(n=p.generate_unique_string()),n={id:n,type:a,value:r},"taxonomy"===a&&(n.taxonomy=r,n.value=d(this).find(".urcr-terms-selector").val()),i.push(n)}),i},extract_rule_actions:function(e,t,a,r){var n,i,c,o,l,s,u,_=[];return t=p.if_empty(t,!0),a=p.if_empty(a,!0),r=p.if_empty(r,!0),(e=e||d(".urcr-rule-actions-container"))&&e instanceof jQuery&&(d("#urcr-rule-action-message-input-tmce").trigger("click"),n=e.find(".urcr-rule-action-type-input").val(),e=e.find('.urcr-rule-action-type-input option[value="'+n+'"]').text(),i=(i=tinyMCE.get("urcr-rule-action-message-input"))?i.getContent():"",c=d(".urcrra-redirect-input-container .urcr-input").val(),o=d(".urcrra-redirect-to-local-page-input-container .urcr-input").val(),l=d(".urcrra-ur-form-input-container .urcr-input").val(),s=d(".urcrra-shortcode-input-container .urcr-input").val(),u=d(".urcrra-shortcode-input-container .urcrra-shortcode-args").val(),t&&i&&""!==i&&(i=encodeURIComponent(i)),a&&c&&""!==c&&(c=encodeURIComponent(c)),r&&u&&""!==u&&(u=encodeURIComponent(u)),_.push({id:p.generate_unique_string(),type:n,label:e||"",message:i||"",redirect_url:c||"",local_page:o||"",ur_form:l||"",shortcode:{tag:s||"",args:u||""}})),_}},e={render_access_rule:function(){var e=c.access_rule_data;c.rule_id&&""!==c.rule_id&&(d("h1.wp-heading-inline").text(c.labels.edit_access_rule),d(".urcr-content-access-rule-title-input").val(c.title),c.access_rule_data.enabled?(d("#urcr-enable-access-rule").attr("checked","checked"),d(".urcr-enable-access-rule-label").text(c.labels.enabled)):(d("#urcr-enable-access-rule").attr("checked",!1),d(".urcr-enable-access-rule-label").text(c.labels.disabled)),c.is_draft?d(".urcr-save-rule-as-draft").text(c.labels.save_draft):d(".urcr-save-rule").text(c.labels.save_rule)),c.is_draft&&d(".urcr-save-rule").text(c.labels.publish_rule),c.rule_id&&""!==c.rule_id&&e?(e.logic_map?this.render_conditional_logic_map(e.logic_map,d(".urcr-conditional-logic-map-container")):n&&console.warn("Logic map is unavailable",e.logic_map),e.actions?this.render_rule_actions(e.actions):n&&console.warn("Rule action is unavailable",e.actions),e.target_contents?this.render_target_contents(e.target_contents):n&&console.warn("Target contents are unavailable",e.target_contents),p.init_all_enhanced_select(),p.init_all_flatpickr(),p.init_all_tooltips()):(n&&!e&&c.rule_id&&console.warn("URCR: Content access rule data is unavailable. It means the rule was unable to be localized or parsed in the server. Could be because of invalid rule ID or invalid rule data.",e),i.add_new_group(d(".urcr-conditional-logic-map-container"))),d(".urcr-widget-header-label").first().text(c.labels.main_logic_group),d(".urcr-spinner-container").remove(),d(".urcrcl-trash").first().remove()},render_conditional_logic_map:function(e,t){if(t=p.if_empty(t,d(".urcr-conditional-logic-map-container")),e&&t&&t instanceof jQuery){if("group"===e.type){i.add_new_group(t,e),t=d("#urcr-conditional-logic-definitions-"+e.id);for(var a=0;a<e.conditions.length;a++){var r=e.conditions[a];this.render_conditional_logic_map(r,t)}}else i.add_new_field(e.type,t,e);return!0}return!1},render_target_contents:function(e,t){if(t=p.if_empty(t,d(".urcr-target-contents-container")),e&&t&&t instanceof jQuery){for(var a=0;a<e.length;a++){var r=e[a];r.type&&l.add_new_target(r.type,t,r)}return!0}return!1},render_rule_actions:function(e,t){if(t=p.if_empty(t,d(".urcr-rule-actions-container")),e&&Array.isArray(e)&&t&&t instanceof jQuery){for(var a=0;a<e.length;a++){var r=e[a];r.type,d(".urcr-rule-action-type-input").val(r.type),d(".urcrra-ur-form-input").val(r.ur_form),d(".urcrra-shortcode-input").val(r.shortcode.tag),d(".urcrra-shortcode-args").val(decodeURIComponent(r.shortcode.args)),d(".urcrra-redirect-input-container .urcr-input").val(decodeURIComponent(r.redirect_url)),d(".urcrra-redirect-to-local-page-input-container .urcr-input").val(r.local_page);for(a=0;a<tinymce.editors.length;a+=1){var n=tinymce.editors[a];if("urcr-rule-action-message-input"===n.id){n.on("init",function(e){e.target.setContent(decodeURIComponent(r.message))});break}}s.updateToggleRuleActionInput(r.type)}return!0}return!1}},i={init:function(){this.init_conditional_logic_field_creation_handler(),this.init_conditional_logic_group_creation_handler(),this.init_conditional_logic_field_deletion_handler()},init_conditional_logic_field_creation_handler:function(){d(document.body).on("change",".urcr-add-new-conditional-logic-field",function(){var e=d(this).val();i.add_new_field(e,d(this).closest(".urcr-settings-widget").children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions")),p.init_all_enhanced_select(),p.init_all_flatpickr(),p.init_all_tooltips()})},init_conditional_logic_group_creation_handler:function(){d(document.body).on("click",".urcr-add-new-conditional-logic-group",function(){var e=d(this).closest(".urcr-settings-widget").children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions");i.add_new_group(e)})},init_conditional_logic_field_deletion_handler:function(){d(document.body).on("click",".urcrcl-trash",function(){($this=d(this)).closest(".urcr-conditional-logic-item").is(".urcr-conditional-logic-map-container > .urcr-settings-widget")||Swal.fire({title:c.labels.are_you_sure,text:c.labels.clfog_deletion_message,icon:"warning",customClass:{confirmButton:"button button-danger",cancelButton:"button button-secondary ur-mr-1"},showCancelButton:!0,confirmButtonText:c.labels["delete"],reverseButtons:!0}).then(function(e){e.value&&$this.closest(".urcr-conditional-logic-item").fadeOut({complete:function(){d(this).remove()}})})})},add_new_group:function(e,t){t=p.if_not_json_object(t,{});var a=c.templates.conditional_logic_group_template,r={ID:t.id||!0},t=[{placeholder:"logic_gate",tag:t.logic_gate||"",value:"is-active"}];p.insert_template(e,a,r,t)},add_new_field:function(e,t,a){switch(a=p.if_not_json_object(a,{}),e){case"roles":this.add_new_roles_field(t,a);break;case"user_registered_date":this.add_new_user_registered_date_picker(t,a);break;case"user_state":this.add_new_user_state_selector(t,a);break;case"email_domain":this.add_new_email_domain_selector(t,a);break;case"post_count":this.add_new_post_count_selector(t,a);break;case"capabilities":this.add_new_capabilities_selector(t,a);break;case"registration_source":this.add_new_registration_source_selector(t,a)}},add_new_roles_field:function(e,t){t=p.if_not_json_object(t,{});var a=p.create_select_tag({className:"urcr-enhanced-select2 urcrcl-roles-selector widefat",multiple:!0,options:c.wp_roles,value:t.value||[]}),r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.roles,type:"roles",tooltip:c.labels.roles_tooltip})},add_new_user_registered_date_picker:function(e,t){var a=(t=p.if_not_json_object(t,{})).value?'value="'+t.value+'"':"",r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcr-flatpickr urcrcl-user-registered-date-picker widefat" type="text" data-mode="range" '+a+"/>",label:c.labels.user_registered_date,type:"user_registered_date",tooltip:c.labels.registered_date_tooltip})},add_new_user_state_selector:function(e,t){t=p.if_not_json_object(t,{});var a=c.templates.conditional_logic_field_template,r=ur_create_toggle_buttons({id:t.id||p.generate_unique_string(),className:"urcr-user-state",value:t.value,buttons:[{text:c.labels.logged_in,value:"logged-in"},{text:c.labels.logged_out,value:"logged-out"}]});p.insert_template(e,a,{ID:t.id||!0,input:r,label:c.labels.user_state,type:"user_state",tooltip:c.labels.user_state_tooltip})},add_new_email_domain_selector:function(e,t){var a=(t=p.if_not_json_object(t,{})).value?'value="'+t.value+'"':"",r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcrcl-email-domain-selector widefat" type="text" '+a+"/>",label:c.labels.email_domain,type:"email_domain",tooltip:c.labels.email_domains_tooltip})},add_new_post_count_selector:function(e,t){var a=(t=p.if_not_json_object(t,{})).value||0,r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcrcl-post-count-selector" type="number" min="0" value="'+a+'"/>',label:c.labels.post_count,type:"post_count",tooltip:c.labels.min_post_count_tooltip})},add_new_capabilities_selector:function(e,t){t=p.if_not_json_object(t,{});var a=p.create_select_tag({className:"urcr-enhanced-select2 urcrcl-capabilities-selector widefat",multiple:!0,options:c.wp_capabilities,value:t.value||[]}),r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.capabilities,type:"capabilities",tooltip:c.labels.capabilities_tooltip})},add_new_registration_source_selector:function(e,t){t=p.if_not_json_object(t,{});var a=p.create_select_tag({className:"urcr-enhanced-select2 urcrcl-rigistration-source-selector widefat",multiple:!0,options:c.registration_sources,value:t.value||[]}),r=c.templates.conditional_logic_field_template;p.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.registration_source,type:"registration_source",tooltip:c.labels.registration_source_tooltip})}},l={init:function(){this.init_target_content_creation_handler(),this.init_subfield_creation_handler(),this.init_target_content_deletion_handler()},init_target_content_creation_handler:function(){d(document.body).on("change",".urcr-add-new-target-contents",function(){var e=d(this).val();l.add_new_target(e,d(this).closest(".urcr-settings-widget").find(".urcr-target-contents-container")),p.init_all_enhanced_select(),p.init_all_tooltips()})},init_subfield_creation_handler:function(){d(document.body).on("change",".urcr-taxonomy-selector",function(){var e=d(this).val(),e=c.terms_list[e]||{},e=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-terms-selector widefat",multiple:!0,options:e,data:{select2_class:"urcr-terms-selector-select2"}});d(this).closest(".urcr-input-container").find(".urcr-terms-selector").remove(),d(this).closest(".urcr-input-container").find(".urcr-terms-selector-select2").closest(".select2-container").remove(),d(this).closest(".urcr-input-container").append(e),p.init_all_enhanced_select()})},init_target_content_deletion_handler:function(){d(document.body).on("click",".urcr-trash-target-content",function(){var t=d(this);Swal.fire({title:c.labels.are_you_sure,text:c.labels.cannot_revert,icon:"warning",customClass:{confirmButton:"button button-danger",cancelButton:"button button-secondary ur-mr-1"},showCancelButton:!0,confirmButtonText:c.labels["delete"],reverseButtons:!0}).then(function(e){e.value&&t.closest(".urcr-target-content").fadeOut({complete:function(){d(this).remove()}})})})},add_new_target:function(e,t,a){switch(a=p.if_not_json_object(a,{}),e){case"post_types":this.add_new_post_types_target(t,a);break;case"taxonomy":this.add_new_taxonomy_target(t,a);break;case"wp_posts":this.add_new_post_targets_picker(t,a);break;case"wp_pages":this.add_new_page_targets_picker(t,a);break;case"whole_site":this.add_new_whole_site_targets_picker(t,a)}},add_new_post_types_target:function(e,t){t=p.if_not_json_object(t,{});var t=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-roles-selector widefat",multiple:!0,options:c.post_types,value:t.value}),a=c.templates.target_content_template;p.insert_template(e,a,{ID:!0,input:t,label:c.labels.post_types,type:"post_types",tooltip:c.labels.post_types_tooltip})},add_new_taxonomy_target:function(e,t){t=p.if_not_json_object(t,{});var a=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-taxonomy-selector widefat",options:c.taxonomies,prepend_empty_option:!0,data:{placeholder:"Select a taxonomy..."},value:t.taxonomy}),r=c.terms_list[t.taxonomy]||{},n="",i=c.templates.target_content_template;t.taxonomy&&""!==t.taxonomy&&(n=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-terms-selector widefat",multiple:!0,options:r,data:{select2_class:"urcr-terms-selector-select2"},value:t.value})),p.insert_template(e,i,{ID:!0,input:a+n,label:c.labels.taxonomy,type:"taxonomy",tooltip:c.labels.taxonomy_tooltip})},add_new_post_targets_picker:function(e,t){t=p.if_not_json_object(t,{});var t=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-capabilities-selector widefat",multiple:!0,options:c.posts,value:t.value}),a=c.templates.target_content_template;p.insert_template(e,a,{ID:!0,input:t,label:c.labels.pick_posts,type:"wp_posts",tooltip:c.labels.pick_posts_tooltip})},add_new_page_targets_picker:function(e,t){t=p.if_not_json_object(t,{});t=p.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-capabilities-selector widefat",multiple:!0,options:c.pages,value:t.value});template=c.templates.target_content_template,p.insert_template(e,template,{ID:!0,input:t,label:c.labels.pick_pages,type:"wp_pages",tooltip:c.labels.pick_pages_tooltip})},add_new_whole_site_targets_picker:function(e,t){t=p.if_not_json_object(t,{});t=p.create_switch_tag({divClassName:"user-registration-switch ur-ml-auto",inputClassName:"user-registration-switch__control hide-show-check enabled",labelClassName:"urcr-enable-access-rule-label",default_checked:'checked="checked"',disabled:'disabled="true"',"default":"Enabled",id:"urcr_whole_site_restriction"});template=c.templates.target_content_template,p.insert_template(e,template,{ID:!0,input:t,label:c.labels.whole_site,type:"whole_site",tooltip:c.labels.whole_site_tooltip})}},s={init:function(){this.fill_options(),this.init_rule_action_input_switcher()},fill_options:function(){var e=p.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-ur-form-input",options:c.ur_forms,prepend_empty_option:!0,data:{placeholder:c.labels.select_ur_form},style:"width: 100% !important;"}),t=p.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-shortcode-input",options:c.shortcodes,prepend_empty_option:!0,data:{placeholder:c.labels.select_ur_shortcode},style:"width: 100% !important;"}),a='<input class="widefat urcrra-shortcode-args" type="text" placeholder="'+c.labels.enter_shortcode_args+'">',r=p.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-redirect-to-local-page-input",options:c.pages,prepend_empty_option:!0,data:{placeholder:c.labels.select_a_page},style:"width: 100% !important;"});d(".urcrra-ur-form-input-container .urcr-body").html(e),d(".urcrra-shortcode-input-container .urcr-body").html(t+a),d(".urcrra-redirect-to-local-page-input-container .urcr-body").html(r)},init_rule_action_input_switcher:function(){d(document.body).on("change",".urcr-rule-action-type-input",function(){s.updateToggleRuleActionInput(d(this).val())})},updateToggleRuleActionInput:function(e){var t=null;switch(e){case"message":t=d(".urcrra-message-input-container");break;case"redirect":t=d(".urcrra-redirect-input-container");break;case"redirect_to_local_page":t=d(".urcrra-redirect-to-local-page-input-container");break;case"ur-form":t=d(".urcrra-ur-form-input-container");break;case"shortcode":t=d(".urcrra-shortcode-input-container")}d(".urcr-rule-action-input-container.urcr-active").slideUp(400),d(".urcr-rule-action-input-container.urcr-active").removeClass("urcr-active"),t&&(t.slideDown(400),t.addClass("urcr-active"))}},a={init:function(){this.init_access_rule_state_label_toggler(),this.init_toggle_animate_title_editor_handler(),this.init_tabs_switcher(),this.init_widgets_toggler(),d(document.body).on("urcr_initializations_complete",function(){a.enable_constant_selection()})},init_access_rule_state_label_toggler:function(){d(document.body).on("change","#urcr-enable-access-rule",function(){d(this).is(":checked")?d(".urcr-enable-access-rule-label").text(c.labels.enabled):d(".urcr-enable-access-rule-label").text(c.labels.disabled)})},init_toggle_animate_title_editor_handler:function(){d(document.body).on("click",".user-registration-editable-title__icon",function(){var e=d(this).siblings(".user-registration-editable-title__input");e.hasClass("is-editing")||e.trigger("focus"),e.toggleClass("is-editing")})},init_tabs_switcher:function(){d(document.body).on("click",".urcr-nav-tab-wrapper .urcr-tab",function(e){e.preventDefault(),d(this).is(".nav-tab-active")||(d(".urcr-nav-tab-wrapper .urcr-tab.nav-tab-active").removeClass("nav-tab-active"),d(this).addClass("nav-tab-active"),(e=d(this).data("tab-content-selector"))&&(d(".urcr-tab-contents-wrapper .urcr-tab-content.urcr-tab-content-active").slideUp(300),d(e).slideDown(300),d(".urcr-tab-contents-wrapper .urcr-tab-content.urcr-tab-content-active").removeClass("urcr-tab-content-active"),d(e).addClass("urcr-tab-content-active")),p.init_all_enhanced_select())})},init_widgets_toggler:function(){var t=["select","input","button","option"];d(document.body).on("click",".urcr-settings-widget .urcr-settings-widget-header",function(e){t.includes(e.target.tagName.toLowerCase())||d(e.target).is(".urcrcl-trash")||d(e.target).closest(".select2").length||d(e.target).is(".urbg-item")||(d(this).closest(".urcr-settings-widget").toggleClass("closed"),p.init_all_enhanced_select())})},enable_constant_selection:function(){d(document.body).on("change",".urcr-constant-selection-enabled",function(){d(this).find(".urcr-logic-field-placeholder").prop("selected",!0)})}},r={create_rule:function(e){var t;p.validate_access_rule_form().result&&(e=p.if_empty(e,d(".urcr-content-access-rule-creator-form")),e=o.extract_rule_data(e),t=d(".urcr-save-rule"),p.append_spinner(t),p.toggleSaveButtons(!0),this.send_data({action:"urcr_create_access_rule",title:d(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(e)},{success:function(e){c.rule_id=e.data.rule_id,p.updateBrowserLocationURL(),t.text(c.labels.save_rule),d("h1.wp-heading-inline").text(c.labels.edit_access_rule),d(".urcr-save-rule-as-draft").remove(),e.success?p.show_success_message(e.data.message):p.show_failure_message(e.data.message)},failure:function(e,t){p.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){p.remove_spinner(t),p.toggleSaveButtons(!1)}}))},save_rule:function(e){var t,a,r;p.validate_access_rule_form().result&&(c.rule_id&&""!==c.rule_id?(e=p.if_empty(e,d(".urcr-content-access-rule-creator-form")),t=o.extract_rule_data(e),a=d(".urcr-save-rule"),r=function(){p.append_spinner(a),p.toggleSaveButtons(!0),this.send_data({action:"urcr_save_access_rule",rule_id:c.rule_id,title:d(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(t)},{success:function(e){d(".urcr-save-rule-as-draft").remove(),a.text(c.labels.save_rule),e.success?p.show_success_message(e.data.message):p.show_failure_message(e.data.message)},failure:function(e,t){p.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){p.remove_spinner(a),p.toggleSaveButtons(!1)}})}.bind(this),c.is_draft?Swal.fire({title:c.labels.are_you_sure,text:c.labels.publish_draft_warning,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:c.labels.publish}).then(function(e){e.value&&(c.is_draft=!1,r())}):r()):n&&console.error("Rule cannot be saved without an ID",c.rule_id))},save_rule_as_draft:function(e){var t,a;p.validate_access_rule_form().result&&(e=p.if_empty(e,d(".urcr-content-access-rule-creator-form")),e=o.extract_rule_data(e),t=d(".urcr-save-rule-as-draft"),a=d(".urcr-save-rule"),p.append_spinner(t),p.toggleSaveButtons(!0),this.send_data({action:"urcr_save_access_rule_as_draft",rule_id:c.rule_id&&""!==c.rule_id?c.rule_id:"",title:d(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(e)},{success:function(e){c.rule_id=e.data.rule_id,p.updateBrowserLocationURL(),a.text(c.labels.publish_rule),t.text(c.labels.save_draft),c.is_draft=!0,e.success?p.show_success_message(e.data.message):p.show_failure_message(e.data.message)},failure:function(e,t){p.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){p.remove_spinner(t),p.toggleSaveButtons(!1)}}))},send_data:function(e,t){var a="function"==typeof t.success?t.success:function(){},r="function"==typeof t.failure?t.failure:function(){},n="function"==typeof t.beforeSend?t.beforeSend:function(){},t="function"==typeof t.complete?t.complete:function(){};!e._wpnonce&&c&&(e._wpnonce=c._nonce),d.ajax({type:"post",dataType:"json",url:c.ajax_url,data:e,beforeSend:n,success:a,error:r,complete:t})}}}(jQuery,window.urcr_localized_data,window.urcr_localized_data.URCR_DEBUG);