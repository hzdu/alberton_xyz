"use strict";jQuery(function(a){var b=Number.isInteger;MPSUM.premium_init=function(){this.__logger_additional_options_visibility(),this.__register_logger_selection_event(),this.__set_cron_related_fields_visibility(a(".eum_cron_schedule").val()),this.__register_cron_schedule(),this.__register_cron_schedule_change(),this.__register_enable_auto_backup_event(),this.__register_disable_auto_backup_event(),this.__register_anonymize_updates(),this.__register_export_settings(),this.__register_import_settings(),this.__register_delay_updates(),this.__register_save_log_settings(),this.__register_check_plugins(),this.__register_disable_safe_mode_event(),this.__register_enable_safe_mode_event(),this.__register_enable_webhook(),this.__register_disable_webhook(),this.__register_enable_version_control_protection(),this.__register_disable_version_control_protection(),this.__register_copy_webhook(),this.__register_whitelist_save(),this.__register_whitelist_reset(),this.__register_disable_unmaintained_plugins_event(),this.__register_enable_unmaintained_plugins_event()},MPSUM.__logger_additional_options_visibility=function(){var b=a(".eum_logger_type");b.each(function(b,c){!0===a("input",c)[0].checked?a(".eum_logger_additional_options",c).show():a(".eum_logger_additional_options",c).hide()})},MPSUM.__register_check_plugins=function(){var b=this;a("#eum-check-plugins").on("click",function(c){c.preventDefault();var d=!1;a("#eum-check-plugins-force").is(":checked")&&(d=!0),jQuery("#eum-check-plugins-status").css("display","none"),b.send_command("check_plugins",{data:{force:d}},function(c){var d=jQuery("#eum-check-plugins-status");a("#eum-check-plugins-force").prop("checked",!1),c.errors?d.css("display","block").removeClass("mpsum-notice").addClass("mpsum-error mpsum-bold").html(c.message):d.css("display","block").removeClass("mpsum-error").addClass("mpsum-notice mpsum-bold").html(c.message),b.__unblockUI()})})},MPSUM.__register_logger_selection_event=function(){a(".eum_logger_type").on("click","input[type=\"checkbox\"]",function(b){var c=a(b.currentTarget).closest(".eum_logger_type");!0===b.currentTarget.checked?c.find(".eum_logger_additional_options").show():c.find(".eum_logger_additional_options").hide()})},MPSUM.__register_cron_schedule=function(){var b=this;a("#save-cron-schedule").on("click",function(c){c.preventDefault(),b.send_command("save_cron_schedule",{data:b.gather_settings("string")},function(c){a("#eum-next-cron-schedule").html(""+c.time),a("#result").css("display","block").html("<div class=\"updated\"><p>"+c.message+"</p></div>").delay(5e3).slideUp(2e3),b.__unblockUI()})})},MPSUM.__register_cron_schedule_change=function(){var b=this;a(".eum_cron_schedule").change(function(c){b.__set_cron_related_fields_visibility(a(c.currentTarget).val())})},MPSUM.__set_cron_related_fields_visibility=function(b){var c=a(".eum_cron_time"),d=a(".eum_week_number"),e=a(".eum_week_days"),f=a(".eum_day_number_wrapper");"twicedaily"===b||"daily"===b?(e.hide(),d.hide(),f.css("display","none")):"weekly"===b?(e.show(),d.hide(),f.css("display","none")):"fortnightly"===b?(e.show(),d.show(),f.css("display","none")):"monthly"===b?(e.hide(),d.hide(),f.css("display","inline-block")):void 0},MPSUM.__register_delay_updates=function(){var c=this;a("#save-delay-updates").on("click",function(d){d.preventDefault();var e=parseInt(a("#delay-updates").val());b(e)&&0<=e?c.send_command("save_delay_updates",{data:c.gather_settings("string")},function(b){a("#result").css("display","block").html("<div class=\"updated\"><p>"+b+"</p></div>").delay(5e3).slideUp(2e3),c.__unblockUI()}):a("#result").css("display","block").html("<div class=\"warning\"><p>"+mpsum.not_valid_number+"</p></div>").delay(5e3).slideUp(2e3)})},MPSUM.__register_save_log_settings=function(){var c=this;a("#save-logs-settings").on("click",function(d){d.preventDefault();var e=parseInt(a("#logs-clearing").val());console.log(e),b(e)&&0<=e?c.send_command("save_logs_settings",{data:c.gather_settings("string")},function(b){a("#result").css("display","block").html("<div class=\"updated\"><p>"+b+"</p></div>").delay(5e3).slideUp(2e3),c.__unblockUI()}):a("#result").css("display","block").html("<div class=\"warning\"><p>"+mpsum.not_valid_number+"</p></div>").delay(5e3).slideUp(2e3)})},MPSUM.__register_anonymize_updates=function(){var b=this;a("#save-anonymize-update-option").on("click",function(c){c.preventDefault(),b.send_command("save_anonymize_updates",{data:b.gather_settings("string")},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(5e3).slideUp(2e3),b.__unblockUI()})})};var c=a("input[type=\"time\"]");c.each(function(b,c){Modernizr.inputtypes.time||(a(c).timepicker({timeFormat:"H:i"}),a(c).addClass("no_date_time_support"),a(c).on("changeTime",function(b){a(b.currentTarget).timepicker("hide")}),a(c).on("keypress",function(a){return a.preventDefault(),!1}))}),c.on("focus",function(){var b=a(this).get(0);Modernizr.inputtypes.time||(a(b).timepicker({timeFormat:"H:i"}),a(b).on("changeTime",function(b){a(b.currentTarget).timepicker("hide")}),a(b).on("keypress",function(a){return a.preventDefault(),!1}))}),MPSUM.__register_enable_auto_backup_event=function(){var b=this;a("#eum-auto-backup").on("click","#eum_ud_enable_auto_backup",function(c){c.preventDefault(),b.send_command("enable_auto_backup",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(5e3).slideUp(2e3),b.__unblockUI();var d=a("#eum_ud_enable_auto_backup");a("#eum-auto-backup-description").removeClass().addClass("mpsum-notice mpsum-bold").text(mpsum.enabled_auto_backup_description),d.prop("id","eum_ud_disable_auto_backup"),d.val(mpsum.disable_auto_backup)})})},MPSUM.__register_export_settings=function(){var b=this;a("#eum-settings-export").click(function(a){a.preventDefault(),b.send_command("export_settings",{},function(a){b.__unblockUI();var c=document.body.appendChild(document.createElement("a"));c.setAttribute("download",mpsum.export_settings_filename),c.setAttribute("style","display:none;"),c.setAttribute("href","data:text/json;charset=UTF-8,"+encodeURIComponent(a)),c.click()})})},MPSUM.__register_import_settings=function(){var b=this;a("#eum-settings-import").click(function(){b.__blockUI();var c=document.getElementById("import_settings");if(0==c.files.length)return alert(mpsum.import_select_file),void b.__unblockUI();var d=c.files[0],e=new FileReader;e.onload=function(){var b=MPSUM.parse_json(this.result);if(mpsum.site_url!==b.meta.site_url){var c=confirm(mpsum.import_confirmation);if(!c)return void MPSUM.__unblockUI()}MPSUM.send_command("import_settings",{data:b.data},function(b){a("#result").css("display","block").html("<div class=\"updated\"><p>"+b+"</p></div>").delay(5e3).slideUp(2e3,function(){window.location.reload()}),MPSUM.__unblockUI()},{json_parse:!1})},e.readAsText(d)})},MPSUM.__register_disable_auto_backup_event=function(){var b=this;a("#eum-auto-backup").on("click","#eum_ud_disable_auto_backup",function(c){c.preventDefault(),b.send_command("disable_auto_backup",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(5e3).slideUp(2e3),b.__unblockUI();var d=a("#eum_ud_disable_auto_backup");a("#eum-auto-backup-description").removeClass().addClass("mpsum-error mpsum-bold").text(mpsum.disabled_auto_backup_description),d.prop("id","eum_ud_enable_auto_backup"),d.val(mpsum.enable_auto_backup)})})},MPSUM.__register_enable_safe_mode_event=function(){var b=this;a("#safe-mode").on("click","#enable-safe-mode",function(c){c.preventDefault(),b.send_command("enable_safe_mode",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(5e3).slideUp(2e3),a("#enable-safe-mode").val(mpsum.disable_safe_mode),a("#enable-safe-mode").attr("id","disable-safe-mode"),b.__unblockUI()})})},MPSUM.__register_disable_safe_mode_event=function(){var b=this;a("#safe-mode").on("click","#disable-safe-mode",function(c){c.preventDefault(),b.send_command("disable_safe_mode",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(5e3).slideUp(2e3),a("#disable-safe-mode").val(mpsum.enable_safe_mode),a("#disable-safe-mode").attr("id","enable-safe-mode"),b.__unblockUI()})})},MPSUM.__register_enable_webhook=function(){var b=this;a("#webhooks").on("click","#enable-webhook,#refresh-webhook",function(c){c.preventDefault(),b.send_command("enable_webhook",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c.message+"</p></div>").delay(2e3).slideUp(2e3),a("#eum-webhook-url").val(c.hook_url),a("#eum-webhook-url-wrapper").removeClass("eum-hidden"),a("#eum-webhook-copy").html(mpsum.webhook_copy);var d=a("#enable-webhook");d.attr("id","disable-webhook"),d.val(mpsum.webhook_disable),b.__unblockUI()})})},MPSUM.__register_disable_webhook=function(){var b=this;a("#webhooks").on("click","#disable-webhook",function(c){c.preventDefault(),b.send_command("disable_webhook",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3),a("#eum-webhook-url-wrapper").addClass("eum-hidden"),a("#eum-webhook-url").val("");var d=a("#disable-webhook");d.attr("id","enable-webhook"),d.val(mpsum.webhook_enable),b.__unblockUI()})})},MPSUM.__register_enable_version_control_protection=function(){var b=this;a("#version-control-protection").on("click","#enable-version-control",function(c){c.preventDefault(),b.send_command("enable_version_control_protection",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3);var d=a("#enable-version-control");d.attr("id","disable-version-control"),d.val(mpsum.version_control_disable),b.__unblockUI()})})},MPSUM.__register_disable_version_control_protection=function(){var b=this;a("#version-control-protection").on("click","#disable-version-control",function(c){c.preventDefault(),b.send_command("disable_version_control_protection",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3);var d=a("#disable-version-control");d.attr("id","enable-version-control"),d.val(mpsum.version_control_enable),b.__unblockUI()})})},MPSUM.__register_enable_unmaintained_plugins_event=function(){var b=this;a(".unmaintained-plugins").on("click","#enable-unmaintained-plugins-check",function(c){c.preventDefault(),b.send_command("enable_unmaintained_plugins",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3);var d=a("#enable-unmaintained-plugins-check");d.attr("id","disable-unmaintained-plugins-check"),d.val(mpsum.disable_unmaintained_plugins),b.__unblockUI()})})},MPSUM.__register_disable_unmaintained_plugins_event=function(){var b=this;a(".unmaintained-plugins").on("click","#disable-unmaintained-plugins-check",function(c){c.preventDefault(),b.send_command("disable_unmaintained_plugins",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3);var d=a("#disable-unmaintained-plugins-check");d.attr("id","enable-unmaintained-plugins-check"),d.val(mpsum.enable_unmaintained_plugins),b.__unblockUI()})})},MPSUM.__register_enable_webhook=function(){var b=this;a("#webhooks").on("click","#enable-webhook,#refresh-webhook",function(c){c.preventDefault(),b.send_command("enable_webhook",{},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c.message+"</p></div>").delay(2e3).slideUp(2e3),a("#eum-webhook-url").val(c.hook_url),a("#eum-webhook-url-wrapper").removeClass("eum-hidden"),a("#eum-webhook-copy").html(mpsum.webhook_copy);var d=a("#enable-webhook");d.attr("id","disable-webhook"),d.val(mpsum.webhook_disable),b.__unblockUI()})})},MPSUM.__register_copy_webhook=function(){a("#webhooks").on("click","#eum-webhook-copy",function(b){b.preventDefault();var c=document.getElementById("eum-webhook-url");c.select(),document.execCommand("copy"),a("#eum-webhook-copy").html(mpsum.webhook_copied)})},MPSUM.__register_whitelist_save=function(){var b=this;a("#eum-whitelabel").on("click","#whitelist-save",function(c){c.preventDefault();var d={plugin_name:a("#eum-whitelabel-text").val(),plugin_author:a("#eum-whitelabel-author").val(),plugin_url:a("#eum-whitelabel-url").val(),notices:a("#whitelist-notices").is(":checked")};b.send_command("whitelist_save",{data:d},function(c){a("#result").css("display","block").html("<div class=\"updated\"><p>"+c+"</p></div>").delay(2e3).slideUp(2e3),b.__unblockUI()})})},MPSUM.__register_whitelist_reset=function(){var b=this;a("#eum-whitelabel").on("click","#whitelist-reset",function(c){c.preventDefault(),b.send_command("whitelist_reset",{},function(c){a("#eum-whitelabel-text").val(c.name),a("#eum-whitelabel-author").val(c.author),a("#eum-whitelabel-url").val(c.url),a("#whitelist-notices").prop("checked",!0),a("#result").css("display","block").html("<div class=\"updated\"><p>"+c.message+"</p></div>").delay(2e3).slideUp(2e3),b.__unblockUI()})})},MPSUM.premium_init()});