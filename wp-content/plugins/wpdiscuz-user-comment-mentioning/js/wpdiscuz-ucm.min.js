jQuery(document).ready(function(e){function t(t){e.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_user",wcm_user_id:t}}).done(function(t){try{!function(t){var n="";if(t.error)n=t.error;else{var o=t.avatar,i=t.user_name,c=t.post_count,u=t.comment_count,s=t.description;n="<div class='ucm-info-header'>"+o,n+="<div class='ucm-right'> <div class='ucm-user-name'>"+i+"</div>",n+="<div class='ucm-counts-wrap'><div class='ucm-post-count'>"+wpdiscuzAjaxObj.wpdumc_text_posts+": "+c+"</div>",n+="<div class='ucm-comment-count'>"+wpdiscuzAjaxObj.wpdumc_text_comments+": "+u+"</div> </div> </div></div>",s&&(n+='<div class=\'ucm-discription\'><i class="fas fa-quote-left" aria-hidden="true"></i> '+s+'<i class="fas fa-quote-right" aria-hidden="true"></div>')}e(".user-tooltip").html(n)}(JSON.parse(t))}catch(e){console.log(e)}})}function n(t){e.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_comment_info",wcm_comment_id:t}}).done(function(t){try{!function(t){var n="";if(t.error)n=t.error;else{var o=t.avatar,i=t.user_name,c=t.comment;n="<div class='ucm-info-header'>"+o,n+=" <div class='ucm-user-name'>"+i+"</div></div>",c&&(n+='<div class=\'ucm-discription\'><i class="fas fa-quote-left" aria-hidden="true"></i> '+c+' <i class="fas fa-quote-right" aria-hidden="true"></div>')}e(".user-tooltip").html(n)}(JSON.parse(t))}catch(e){console.log(e)}})}function o(){e("body").children(".user-tooltip").hasClass("user-tooltip")||e("body").append("<div class='user-tooltip'><i class='fa fa-spinner fa-spin' style='font-size:24px;color:#888'></i></div>")}e(function(){var i,c;parseInt(wpdiscuzAjaxObj.wpdumc_is_mobile)&&e(document).on("click",".hint",function(e){return e.preventDefault(),e.stopPropagation(),!1}),e(document).on("mouseover",".hint",function(){i!==e(this).data("ucm_user_id")&&(i=e(this).data("ucm_user_id")),""!==i&&t(i)}),e(document).on("mouseover",".ucm-comment-id",function(){c!==e(this).text()&&(c=e(this).text()),""!==c&&n(c)}),e(document).on("mousemove",".ucm-comment-id",function(t){var n=window.innerWidth,o=window.innerHeight,i=t.pageX+20,c=t.pageY+20;n<400?i=(n-200)/2:n-t.pageX<200&&(i=t.pageX-200),o-(t.pageY-e(window).scrollTop())<200&&(c=t.pageY-90),e(".user-tooltip").css({top:c,left:i}).show()}),e(document).on("mouseover",".ucm-comment-id",function(){o()}),e(document).on("mouseout",".ucm-comment-id",function(){e(".user-tooltip").remove()}),e(document).on("mousemove",".hint",function(t){var n=window.innerWidth,o=window.innerHeight,i=t.pageX+20,c=t.pageY+20;n<400?i=(n-200)/2:n-t.pageX<200&&(i=t.pageX-200),o-(t.pageY-e(window).scrollTop())<200&&(c=t.pageY-90),e(".user-tooltip").css({top:c,left:i}).show()}),e(document).on("mouseout",".hint",function(){e(".user-tooltip").remove()}),e(document).on("mouseover",".hint",function(){o()})}),e(document).on("click",".ucm-comment-id",function(){var t=e(this).text().replace("#","");0===e("body").find("#comment-"+t).length&&location.reload(!0)})});var wpdumcItems,wpdumcCachequery=new Map,wpdumcSearchTerm="",wpdumcReng=null,wpdumcRenderListXHR=null;function wpdiscuzUMCRenderList(e,t,n){e.length>0?wpdumcCachequery.has(e)?t(wpdumcCachequery.get(e),e):(null!==wpdumcRenderListXHR&&wpdumcRenderListXHR.abort(),wpdumcRenderListXHR=jQuery.ajax({type:"post",url:wpdiscuzAjaxObj.url,data:{action:"get_all_users",key_name:e,post_id:wpdiscuzAjaxObj.wc_post_id}}).done(function(n){try{var o=JSON.parse(n);if("number"!=typeof o){var i=jQuery.makeArray(o);wpdumcCachequery.set(e,i),t(i,e)}else t([],e)}catch(e){console.log(e)}})):t([],e)}function wpdUMCInsertItem(e,t){var n,o=wpDiscuzEditor.currentEditor,i=" @"+e.value+" ";null!==o&&(n=wpdumcReng.index-(wpdumcSearchTerm.length+1),o.deleteText(n,wpdumcSearchTerm.length+1,Quill.sources.USER),o.insertText(n,i,Quill.sources.USER),o.setSelection(n+i.length,Quill.sources.USER))}function wpdUMCRenderItem(e,t){wpdumcSearchTerm=t;var n=wpDiscuzEditor.currentEditor;return n.emitter.emit(["editor-change",null,null,"user"]),wpdumcReng=n.getSelection(),`<div title="${parseInt(wpdiscuzAjaxObj.wpdumc_displayNicename)?`@${e.value}`:""}"><span class="us-av">${e.avatar}</span><span class="us-dn">${e.display_name}</span></div>`}