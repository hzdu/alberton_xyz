function wcpr_resize_masonry_items(e=!1){e?jQuery(".wcpr-grid-loadmore .wcpr-grid-item").each((function(){wcpr_resize_masonry_item(jQuery(this))})):jQuery(".wcpr-grid-loadmore .wcpr-grid-item:not(.wcpr-grid-item-init)").each((function(){wcpr_resize_masonry_item(jQuery(this))}))}function wcpr_resize_masonry_item(e){e=jQuery(e);let i,t,r=0,a=parseInt(jQuery(".wcpr-grid").data("wcpr_columns")||3);if(e.find(".reviews-images-wrap-right .reviews-images").length&&(i=e.find(".reviews-images-wrap-right .reviews-images"),r=i.outerHeight(),0===r)){t=e.find(".wcpr-content").outerWidth();let n=parseFloat(i.attr("width")||0),s=parseFloat(i.attr("height")||0);0===t&&(t=((jQuery(".wcpr-grid").outerWidth()?jQuery(".wcpr-grid").outerWidth():jQuery("#reviews").outerWidth()?jQuery("#reviews").outerWidth():jQuery(".woocommerce-Tabs-panel").outerWidth()?jQuery(".woocommerce-Tabs-panel").outerWidth():200)-20*(a-1))/a),r=0!==s?Math.round(t/n*s):t}let n=e.find(".wcpr-content").outerHeight(),s=e.find(".review-content-container").outerHeight();if(0===s){t||(t=e.find(".wcpr-content").outerWidth(),0===t&&(t=((jQuery(".wcpr-grid").outerWidth()?jQuery(".wcpr-grid").outerWidth():jQuery("#reviews").outerWidth()?jQuery("#reviews").outerWidth():jQuery(".woocommerce-Tabs-panel").outerWidth()?jQuery(".woocommerce-Tabs-panel").outerWidth():200)-20*(a-1))/a)),jQuery("body").append('<div class="review-content-container-temp" style="width: '+t+'px; visibility: hidden; ">'+e.find(".review-content-container").html()+"</div>");let i=jQuery(".review-content-container-temp");i.find(".wcpr-review-content-full").remove(),s=i.outerHeight(),i.remove()}n<s+r&&(n=s+r);let o=Math.ceil((n+20)/21);e.addClass("wcpr-grid-item-init").css("grid-row-end","span "+o)}jQuery(document).ready((function(e){"use strict";let i=!1;/iPad/i.test(navigator.userAgent)||/Safari/i.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor)&&!/Mobi|Android/i.test(navigator.userAgent)?i=!0:e(".wcpr-enable-box-shadow").addClass("wcpr-fix-box-shadow");let t,r=-1,a=0;function n(){let i=parseInt(e("html").css("top"));e("html").removeClass("wcpr-noscroll"),e("html,body").scrollTop(-i)}function s(i){a=0,r=i,i>=t.length&&(r=0),i<0&&(r=t.length-1);let n,s=e("#reviews-content-left-modal"),o=e("#reviews-content-left-main");if(n=t.eq(r),s.html(""),o.html(""),0===n.find(".reviews-images-container").length)e(".wcpr-modal-light-box").addClass("wcpr-no-images");else{s.html(n.find(".reviews-images-wrap-left").html());let i=n.find(".reviews-images-wrap-right").html();i&&(e(".wcpr-modal-light-box").removeClass("wcpr-no-images"),o.html(i)),s.find(".reviews-images").map((function(){let i=e(this).data("src");i&&e(this).attr("src",i)})),s.find(".reviews-images").closest("a").on("click",(function(){a=e(this).data("image_index");let i=e(this).attr("href"),t="";return jQuery(this).hasClass("reviews-iframe")||jQuery(this).find(".reviews-iframe").length?t=jQuery(`<iframe class="reviews-images reviews-iframe" data-original_src="${i}" src="${i}" frameborder="0" allowfullscreen></iframe>`):jQuery(this).hasClass("reviews-videos")||jQuery(this).find(".reviews-videos").length?t=jQuery(`<video class="reviews-images reviews-videos" data-original_src="${i}" src="${i}" controls></video>`):(t=jQuery(`<img class="reviews-images" data-original_src="${i}" src="${i}">`),t.attr("title",o.find(".reviews-images").attr("title"))),t.attr({width:o.find(".reviews-images").attr("width"),height:o.find(".reviews-images").attr("width")}),o.find(".reviews-images").replaceWith(t),o.find("source").attr("srcset",i),o.find(".wcpr-review-image-caption").html(e(this).data("image_caption")),!1}))}e("#reviews-content-right .reviews-content-right-meta").html(n.find(".review-content-container").html()),e(".wcpr-modal-light-box").fadeIn(200)}switch(woocommerce_photo_reviews_params.masonry_popup){case"review":t=e(".wcpr-grid-item"),e(".wcpr-close").on("click",(function(){n(),e(".wcpr-modal-light-box").fadeOut(200),r=-1})),e(".wcpr-modal-light-box .wcpr-overlay").on("click",(function(){n(),e(".wcpr-modal-light-box").fadeOut(200),r=-1})),e("#reviews-content-left-main").on("click",".reviews-images",(function(){let i=e(this),t=[];e("#reviews-content-left-modal").find("a").map((function(){let i=e(this).find(".reviews-images"),r=e(this).data("image_src")?e(this).data("image_src"):i.attr("src"),a=e(this).data("image_caption")?e(this).data("image_caption"):parseInt(e(this).data("image_index"))+1+"/"+e("#reviews-content-left-modal").find("a").length;t.push({href:r,title:a})})),0==t.length&&t.push({href:i.data("original_src")?i.data("original_src"):i.attr("src"),title:i.parent().find(".wcpr-review-image-caption").html()}),e.swipebox(t,{hideBarsDelay:1e5,initialIndexOnArray:a})})),e(document).keydown((function(i){e.swipebox.isOpen||"none"!=e(".wcpr-modal-light-box").css("display")&&(27==i.keyCode&&(n(),e(".wcpr-modal-light-box").fadeOut(200),r=-1),-1!=r&&(37==i.keyCode&&s(r-=1),39==i.keyCode&&s(r+=1)))})),e(document).on("click",".wcpr-grid-item",(function(){let i;t=e(".wcpr-grid-item"),i=t.index(e(this)),i>=0&&(s(i),function(){if(e(document).height()>e(window).height()){let i=e("html").scrollTop()?e("html").scrollTop():e("body").scrollTop();e("html").addClass("wcpr-noscroll").css("top",-i)}}())})),e(".wcpr-next").on("click",(function(){s(r+=1)})),e(".wcpr-prev").on("click",(function(){s(r-=1)}));break;case"image":e(document).on("click",".wcpr-grid-item .reviews-images",(function(i){let t=e(this);i.stopPropagation();let r=t.closest(".reviews-images-container"),a=[];r.find(".reviews-images-wrap-left").find("a").map((function(){let i=e(this).find(".reviews-images"),t=e(this).data("image_src")?e(this).data("image_src"):i.attr("src"),n=e(this).data("image_caption")?e(this).data("image_caption"):parseInt(e(this).data("image_index"))+1+"/"+r.find(".reviews-images-wrap-left").find("a").length;a.push({href:t,title:n})})),0==a.length&&a.push({href:t.data("original_src")?t.data("original_src"):t.attr("src"),title:t.parent().find(".wcpr-review-image-caption").html()}),console.log(a),e.swipebox(a,{hideBarsDelay:1e5,initialIndexOnArray:0})}))}return jQuery(document.body).on("wcpr_ajax_load_more_reviews_end wcpr_ajax_pagination_end",(function(){setTimeout((function(){wcpr_resize_masonry_items()}),100)})),e(document).on("skeleton-loaded",(function(){wcpr_resize_masonry_items(!0)})),e(document).on("tabactivate",(function(e,i){wcpr_resize_masonry_items(!0)})),jQuery(document.body).on("click",".wcpr-read-more",(function(i){i.stopPropagation();let t=e(this).closest(".wcpr-review-content"),r=t.find(".wcpr-review-content-full").html();r&&t.html(r),t.closest(".wcpr-grid-item").removeClass("wcpr-grid-item-init"),wcpr_resize_masonry_items()})),!1})),jQuery(window).on("load",(function(){wcpr_resize_masonry_items()})).on("resize",(function(){wcpr_resize_masonry_items()}));