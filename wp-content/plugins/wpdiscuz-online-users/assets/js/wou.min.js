jQuery(document).ready(function(o){var t=wouVars.wouAjaxUrl,i=wouVars.wouCheckFrequency,e=wouVars.wouNotificationPopupTimeout,n=wouVars.wouCurrentUserEmail,u=wouVars.wouCurrentUserName,a=wouVars.wouCurrentOnlineUsers,s=parseInt(wouVars.wouIsShowNotificationPopup),r={users:[]},c=[];function w(){p({email:n,name:u,onlineUsers:a},"wouCheckOnlineUsers").done(function(t){try{var i=JSON.parse(t),n=o(".wou-status");if(a=i.onlineUsers,c=i.pushItems,o.each(n,function(t){var i=o(n[t]),e=o(".wou-uuid",i).val();if(wouVars.wouCurrentUser!=e)if(o.inArray(e,a)>=0)o(i).hasClass("wou-status-offline")&&(o(i).removeClass("wou-status-offline"),o(i).addClass("wou-status-online"),o(".wou-status-phrase",i).text(wouVars.wouPhraseStatusOnline));else if(o(i).hasClass("wou-status-online")){o(i).removeClass("wou-status-online"),o(i).addClass("wou-status-offline"),o(".wou-status-phrase",i).text(wouVars.wouPhraseStatusOffline);var u=o('.wou-notification-item input[value="'+e+'"]');if(u.length){var s=u.parent();o(".wou-close-modal",s).trigger("click")}}}),r.users=c,s&&r.users.length)p(r,"wouPushNotification").done(function(t){try{var i=JSON.parse(t).data;i&&(o("#wou-notification-popup").show(),o.each(r.users,function(t){var n=o(i[t]),u=r.users[t].email,a=o('#wou-notification-popup .wou-notification-item :input[value="'+u+'"]');if(a.length){var s=a.parents(".wou-notification-item");o(".wou-notification-item-time",s).val(e)}else o("#wou-notification-popup-flex").append(n),n.fadeIn(500)}),r.users=[])}catch(o){console.log(o)}})}catch(o){console.log(o)}})}function f(){0==o("#wou-notification-popup .wou-notification-item").length&&o("#wou-notification-popup").hide()}function l(){o("#wou-notification-popup .wou-notification-item").each(function(){var t=o(".wou-notification-item-time",this).val();o(".wou-notification-item-time",this).val(--t),o(".wou-notification-item-time",this).val()<=0&&(o(this).remove(),f())})}function p(i,e){return o.ajax({type:"POST",url:t,data:{wouAjaxData:JSON.stringify(i),action:e}})}!isNaN(i)&&i>0&&setTimeout(function(){w(),setInterval(w,i),s&&setInterval(l,1e3)},5e3),o(document).on("click",".wou-close-modal",function(){var t=o(this).parents(".wou-notification-item");t.fadeOut(250,function(){t.remove(),f()})})});